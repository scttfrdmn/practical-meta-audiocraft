<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Introduction to AudioGen: AI-Powered Sound Effects Generation</title>
  <meta name="description" content="“For our indie game, we need dozens of different environmental sounds - everything from gentle forest ambience to futuristic mechanical noises. We don’t have...">
  <link rel="canonical" href="https://scttfrdmn.github.io/practical-meta-audiocraft/chapters/part3/introduction-to-audiogen/">
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      margin: 0;
      padding: 0;
    }
    .wrapper {
      max-width: 100%;
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 0 20px;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    h1 { color: #1a73e8; }
    h2 { color: #34a853; }
    a {
      color: #1a73e8;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .site-header {
      border-bottom: 1px solid #eee;
      padding: 15px 0;
      margin-bottom: 30px;
    }
    .site-title {
      margin: 0;
      font-size: 1.8rem;
    }
    .site-title a {
      color: #1a73e8;
      text-decoration: none;
    }
    .site-nav {
      float: right;
      margin-top: 10px;
    }
    .site-nav .page-link {
      margin-left: 20px;
    }
    .nav-trigger {
      display: none;
    }
    .menu-icon {
      display: none;
    }
    .page-content {
      padding: 20px 0;
    }
    .site-footer {
      border-top: 1px solid #eee;
      padding: 30px 0;
      margin-top: 60px;
    }
    .footer-col-wrapper {
      display: flex;
      flex-wrap: wrap;
    }
    .footer-col {
      flex: 1;
      min-width: 200px;
      padding-right: 20px;
    }
    code {
      background-color: #f5f5f5;
      padding: 2px 5px;
      border-radius: 3px;
    }
    pre {
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
    }
    .highlight {
      background-color: #f5f5f5;
      border-radius: 5px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
    }
    th {
      background-color: #f5f5f5;
      text-align: left;
    }
    button, .button {
      display: inline-block;
      background-color: #1a73e8;
      color: white !important;
      padding: 10px 20px;
      border-radius: 4px;
      font-weight: bold;
      margin-top: 20px;
      border: none;
      cursor: pointer;
      text-decoration: none !important;
    }
    button:hover, .button:hover {
      background-color: #0d65d9;
    }
    .feature {
      background-color: #f5f5f5;
      border-radius: 8px;
      padding: 20px;
      border-left: 4px solid #1a73e8;
      margin-bottom: 20px;
    }
    
    @media screen and (max-width: 600px) {
      .site-nav {
        position: absolute;
        top: 70px;
        right: 20px;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 5px;
        text-align: right;
        padding: 0;
        z-index: 1;
      }
      .site-nav .page-link {
        display: block;
        padding: 10px;
        margin: 0;
      }
      .site-nav .menu-icon {
        display: block;
        float: right;
        width: 36px;
        height: 26px;
        line-height: 0;
        padding-top: 10px;
        text-align: center;
      }
      .site-nav .trigger {
        clear: both;
        display: none;
      }
      .site-nav input:checked ~ .trigger {
        display: block;
        padding-bottom: 5px;
      }
      .footer-col-wrapper {
        flex-direction: column;
      }
      .footer-col {
        margin-bottom: 20px;
      }
    }
  </style>
</head><body>
    <div class="wrapper">
      <header class="site-header">
        <div class="container">
          <h1 class="site-title"><a href="/practical-meta-audiocraft/">Practical Meta AudioCraft</a></h1>
          <nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
              <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                  <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484c0-0.82,0.665-1.485,1.484-1.485 h15.032C17.335,0,18,0.665,18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516 c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,6.031,18,6.696,18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516c0-0.82,0.665-1.483,1.484-1.483h15.032 C17.335,12.031,18,12.696,18,13.516z"/>
                </svg>
              </span>
            </label>

            <div class="trigger">
              <a class="page-link" href="/practical-meta-audiocraft/">Home</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part1/introduction/">Getting Started</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part2/basic-music/">MusicGen</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part3/introduction-to-audiogen/">AudioGen</a>
              <a class="page-link" href="/practical-meta-audiocraft/tutorials/getting-started/">Tutorials</a>
            </div>
          </nav>
        </div>
      </header>

      <main class="page-content" aria-label="Content">
        <div class="container">
          <div class="chapter">
  <div class="chapter-header">
    <div class="chapter-metadata">
      <span class="difficulty beginner">Beginner</span>
      <span class="estimated-time">45</span>
    </div>
    <h1>Introduction to AudioGen: AI-Powered Sound Effects Generation</h1>
  </div>
  
  
  
  <blockquote>
  <p><em>“For our indie game, we need dozens of different environmental sounds - everything from gentle forest ambience to futuristic mechanical noises. We don’t have the budget for a professional sound library or a dedicated sound designer. I’ve heard AI can generate sound effects now, but I have no idea how to get started or if the quality will be good enough for our project.”</em></p>

  <p>— Riley Chen, indie game developer</p>
</blockquote>

<h1 id="chapter-10-introduction-to-audiogen-ai-powered-sound-effects-generation">Chapter 10: Introduction to AudioGen: AI-Powered Sound Effects Generation</h1>

<h2 id="the-challenge">The Challenge</h2>

<p>You’re developing a project that requires a wide variety of environmental sounds, ambient audio, or sound effects. Professional sound libraries can be expensive, recording your own sounds isn’t always practical, and finding the exact sounds you need can be time-consuming. You need a flexible solution that can generate high-quality, customizable sound effects on demand.</p>

<p>In this chapter, we’ll introduce AudioGen, Meta’s AI model for generating non-musical audio, and explore how it can be used to create realistic environmental sounds, ambient backgrounds, and sound effects for a variety of applications.</p>

<h2 id="learning-objectives">Learning Objectives</h2>

<p>By the end of this chapter, you will be able to:</p>

<ul>
  <li>Understand how AudioGen differs from MusicGen and when to use each model</li>
  <li>Generate a wide variety of sound effects using natural language descriptions</li>
  <li>Optimize prompts specifically for sound effect generation</li>
  <li>Create layered soundscapes by combining multiple generated audio elements</li>
  <li>Identify appropriate use cases for AI-generated sound effects</li>
  <li>Understand AudioGen’s capabilities and limitations</li>
</ul>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>Python environment with AudioCraft installed (see Chapter 2)</li>
  <li>Basic understanding of audio concepts</li>
  <li>Familiarity with Python programming</li>
</ul>

<h2 id="key-concepts-understanding-audiogen">Key Concepts: Understanding AudioGen</h2>

<h3 id="what-is-audiogen">What is AudioGen?</h3>

<p>AudioGen is part of Meta’s AudioCraft family of models, specifically designed to generate non-musical audio such as environmental sounds, ambient backgrounds, and sound effects. While MusicGen focuses on creating structured musical content, AudioGen specializes in generating a wide range of everyday sounds, from rainfall and animal noises to mechanical equipment and urban environments.</p>

<h3 id="how-audiogen-differs-from-musicgen">How AudioGen Differs from MusicGen</h3>

<p>It’s important to understand the key differences between these two models:</p>

<table>
  <thead>
    <tr>
      <th>Feature</th>
      <th>AudioGen</th>
      <th>MusicGen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Primary Use</strong></td>
      <td>Sound effects, ambience, environmental audio</td>
      <td>Music, songs, musical compositions</td>
    </tr>
    <tr>
      <td><strong>Output Structure</strong></td>
      <td>Naturalistic sounds without musical structure</td>
      <td>Structured music with rhythm, melody, harmony</td>
    </tr>
    <tr>
      <td><strong>Tempo Control</strong></td>
      <td>Less relevant (sounds rarely have tempo)</td>
      <td>Important for musical synchronization</td>
    </tr>
    <tr>
      <td><strong>Prompt Focus</strong></td>
      <td>Descriptions of sound sources, qualities, environments</td>
      <td>Musical styles, instruments, mood, genre</td>
    </tr>
    <tr>
      <td><strong>Available Sizes</strong></td>
      <td>Medium and Large only</td>
      <td>Small, Medium, and Large</td>
    </tr>
    <tr>
      <td><strong>Typical Duration</strong></td>
      <td>3-10 seconds (optimal for sounds)</td>
      <td>8-30 seconds (optimal for music)</td>
    </tr>
    <tr>
      <td><strong>Example Prompts</strong></td>
      <td>“Heavy rain falling on a metal roof”</td>
      <td>“Upbeat electronic dance track with synths”</td>
    </tr>
  </tbody>
</table>

<p>Understanding these differences helps you choose the right model for your specific audio generation needs.</p>

<h3 id="when-to-use-audiogen-vs-musicgen">When to Use AudioGen vs. MusicGen</h3>

<ul>
  <li><strong>Use AudioGen when you need</strong>:
    <ul>
      <li>Environmental sounds (rain, wind, fire, etc.)</li>
      <li>Ambient backgrounds (forest, city, office, etc.)</li>
      <li>Sound effects (impacts, machinery, animals, etc.)</li>
      <li>Naturalistic, non-musical audio</li>
    </ul>
  </li>
  <li><strong>Use MusicGen when you need</strong>:
    <ul>
      <li>Music with clear harmonic structure</li>
      <li>Songs with recognizable instruments</li>
      <li>Pieces with rhythm and melody</li>
      <li>Musical accompaniment or soundtrack elements</li>
    </ul>
  </li>
</ul>

<h2 id="your-first-sound-effect-generation">Your First Sound Effect Generation</h2>

<p>Let’s start by creating a simple sound effect using AudioGen. The process is similar to using MusicGen, with a few key differences:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># basic_audiogen.py
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">AudioGen</span>
<span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>

<span class="k">def</span> <span class="nf">generate_sound_effect</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s">"sound_effects"</span><span class="p">):</span>
    <span class="s">"""
    Generate a sound effect using AudioGen.
    
    Args:
        prompt (str): Description of the sound to generate
        duration (float): Length of sound in seconds
        output_dir (str): Directory to save the output
        
    Returns:
        str: Path to the generated audio file
    """</span>
    <span class="c1"># Create output directory if it doesn't exist
</span>    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1"># Determine the device to use
</span>    <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>  <span class="c1"># Apple Silicon GPU
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Using MPS (Metal) for generation"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>  <span class="c1"># NVIDIA GPU
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Using CUDA for generation"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>  <span class="c1"># Fallback to CPU
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Using CPU for generation (this will be slow)"</span><span class="p">)</span>
    
    <span class="c1"># Load the AudioGen model
</span>    <span class="c1"># Note: AudioGen only offers "medium" and "large" sizes
</span>    <span class="n">model</span> <span class="o">=</span> <span class="n">AudioGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="s">"medium"</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    
    <span class="c1"># Set generation parameters
</span>    <span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
        <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>       <span class="c1"># Duration in seconds
</span>        <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>         <span class="c1"># Controls randomness (0.5-1.5)
</span>        <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>               <span class="c1"># Controls diversity
</span>        <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>               <span class="c1"># Nucleus sampling (0.0 to disable)
</span>    <span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generating sound: '</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">'"</span><span class="p">)</span>
    
    <span class="c1"># Generate the sound effect
</span>    <span class="n">wav</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>
    
    <span class="c1"># Create a clean filename based on the prompt
</span>    <span class="n">safe_prompt</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="s">"_"</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prompt</span><span class="p">)[:</span><span class="mi">30</span><span class="p">]</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">safe_prompt</span><span class="si">}</span><span class="s">"</span>
    
    <span class="c1"># Save the audio file
</span>    <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">audio_write</span><span class="p">(</span>
        <span class="n">output_path</span><span class="p">,</span>             <span class="c1"># Path without extension
</span>        <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">(),</span>            <span class="c1"># Audio tensor (first in batch)
</span>        <span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>       <span class="c1"># Sample rate (32kHz for AudioGen)
</span>        <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span><span class="p">,</span>     <span class="c1"># Normalize for consistent volume
</span>    <span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Sound effect saved to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Try generating a rain sound effect
</span>    <span class="n">generate_sound_effect</span><span class="p">(</span>
        <span class="n">prompt</span><span class="o">=</span><span class="s">"Heavy rain falling on a tin roof with distant thunder"</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="mf">7.0</span>  <span class="c1"># 7 seconds of audio
</span>    <span class="p">)</span>
</code></pre></div></div>

<p>When you run this script, it will:</p>
<ol>
  <li>Load the AudioGen model (medium size)</li>
  <li>Generate a 7-second sound effect of rain on a tin roof</li>
  <li>Save the result as a WAV file in the “sound_effects” directory</li>
</ol>

<p>The key differences from MusicGen are:</p>
<ul>
  <li>We’re using AudioGen instead of MusicGen</li>
  <li>Our prompt describes a sound rather than music</li>
  <li>We typically use shorter durations for sound effects</li>
</ul>

<h2 id="sound-categories-and-prompt-techniques">Sound Categories and Prompt Techniques</h2>

<p>AudioGen can generate a wide variety of sounds across different categories. Understanding these categories and how to craft prompts for them is essential for getting the best results.</p>

<h3 id="common-sound-categories">Common Sound Categories</h3>

<p>Here are some of the main sound categories AudioGen excels at:</p>

<ol>
  <li><strong>Natural Elements</strong>
    <ul>
      <li>Weather: rain, wind, thunder, hail</li>
      <li>Water: rivers, ocean waves, waterfalls, dripping</li>
      <li>Fire: campfires, fireplaces, forest fires, matches</li>
    </ul>
  </li>
  <li><strong>Urban Environments</strong>
    <ul>
      <li>Traffic: cars, buses, horns, engines</li>
      <li>Crowds: cafes, restaurants, markets, stadiums</li>
      <li>Construction: drills, hammers, saws, cranes</li>
    </ul>
  </li>
  <li><strong>Domestic Sounds</strong>
    <ul>
      <li>Household: kitchen, bathroom, appliances</li>
      <li>Interior: footsteps, doors, furniture</li>
      <li>Electronic: computers, phones, TVs, gadgets</li>
    </ul>
  </li>
  <li><strong>Animals and Wildlife</strong>
    <ul>
      <li>Birds: chirping, singing, fluttering wings</li>
      <li>Mammals: dogs barking, cats purring, horses galloping</li>
      <li>Insects: buzzing, chirping, flying</li>
    </ul>
  </li>
  <li><strong>Mechanical and Industrial</strong>
    <ul>
      <li>Machines: motors, engines, pumps, generators</li>
      <li>Tools: drills, saws, hammers, lathes</li>
      <li>Vehicles: cars, trains, airplanes, boats</li>
    </ul>
  </li>
  <li><strong>Abstract and Designed</strong>
    <ul>
      <li>UI sounds: notifications, alerts, feedback</li>
      <li>Sci-fi: futuristic machinery, alien environments</li>
      <li>Fantasy: magical effects, otherworldly elements</li>
    </ul>
  </li>
</ol>

<h3 id="prompt-engineering-for-sound-effects">Prompt Engineering for Sound Effects</h3>

<p>Unlike music generation, where genre and mood are primary considerations, sound effect prompts should focus on:</p>

<ol>
  <li><strong>Sound Source</strong>: What is making the sound?</li>
  <li><strong>Environment</strong>: Where is the sound occurring?</li>
  <li><strong>Qualities</strong>: How would you describe the sound itself?</li>
  <li><strong>Dynamics</strong>: Does the sound change over time?</li>
</ol>

<p>Here are some prompt templates that work well with AudioGen:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[SOUND SOURCE] in a [ENVIRONMENT] with [ADDITIONAL ELEMENTS]
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ADJECTIVE] [SOUND SOURCE] [ACTION] with [QUALITIES] and [VARIATIONS]
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ENVIRONMENT] ambience with [SOUND SOURCE 1], [SOUND SOURCE 2], and [BACKGROUND ELEMENTS]
</code></pre></div></div>

<h3 id="prompt-examples-by-category">Prompt Examples by Category</h3>

<p>Let’s look at effective prompts for different sound categories:</p>

<h4 id="natural-elements">Natural Elements</h4>
<ul>
  <li>“Heavy rain falling on a metal roof with occasional thunder in the distance”</li>
  <li>“Strong wind blowing through pine trees with leaves rustling and branches creaking”</li>
  <li>“Gentle stream flowing over smooth rocks with water gurgling and splashing”</li>
</ul>

<h4 id="urban-environments">Urban Environments</h4>
<ul>
  <li>“Busy city street with car horns, passing vehicles, and distant construction noise”</li>
  <li>“Crowded restaurant with conversations, clinking dishes, and kitchen sounds in the background”</li>
  <li>“Subway station with train arriving, brakes screeching, and automated announcements”</li>
</ul>

<h4 id="domestic-sounds">Domestic Sounds</h4>
<ul>
  <li>“Kitchen with chopping vegetables, sizzling pan, and timer beeping occasionally”</li>
  <li>“Old house at night with creaking floorboards, ticking clock, and wind through windows”</li>
  <li>“Bathroom with shower running, water hitting tiles, and exhaust fan humming”</li>
</ul>

<h4 id="animals-and-wildlife">Animals and Wildlife</h4>
<ul>
  <li>“Dawn chorus in spring forest with various birds singing, calling, and fluttering between trees”</li>
  <li>“Dog park with different dogs barking, playing, and running around”</li>
  <li>“Summer night with crickets chirping, frogs croaking, and occasional owl hoots”</li>
</ul>

<h4 id="mechanical-and-industrial">Mechanical and Industrial</h4>
<ul>
  <li>“Old car engine starting, idling roughly, then revving up”</li>
  <li>“Factory floor with pneumatic machinery, conveyor belts, and distant forklifts”</li>
  <li>“Construction site with jackhammers, power drills, and workers shouting over the noise”</li>
</ul>

<h4 id="abstract-and-designed">Abstract and Designed</h4>
<ul>
  <li>“Futuristic spacecraft interior with humming engines, beeping computers, and air circulation”</li>
  <li>“Magic spell being cast with sparkling energy, rushing wind, and deep resonant tones”</li>
  <li>“Series of technology notification sounds - message alerts, calendar reminders, and updates”</li>
</ul>

<h2 id="implementing-a-sound-category-explorer">Implementing a Sound Category Explorer</h2>

<p>To better understand AudioGen’s capabilities across different sound categories, let’s implement a sound category explorer:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># sound_category_explorer.py
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">AudioGen</span>
<span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>

<span class="k">class</span> <span class="nc">SoundCategoryExplorer</span><span class="p">:</span>
    <span class="s">"""
    Tool for exploring different sound categories with AudioGen.
    
    This class allows systematic generation of sound examples across
    multiple categories to understand AudioGen's capabilities.
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_size</span><span class="o">=</span><span class="s">"medium"</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s">"""Initialize the explorer with a specific model size."""</span>
        <span class="c1"># Determine device automatically if not specified
</span>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Using MPS (Metal) for generation"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Using CUDA for generation"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Using CPU for generation (this will be slow)"</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">model_size</span> <span class="o">=</span> <span class="n">model_size</span>
        
        <span class="c1"># Define sound categories with example prompts
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">categories</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"natural"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"rain"</span><span class="p">:</span> <span class="s">"Heavy rain falling on a tin roof with occasional thunder in the distance"</span><span class="p">,</span>
                <span class="s">"wind"</span><span class="p">:</span> <span class="s">"Strong wind blowing through pine trees with creaking branches and whistling"</span><span class="p">,</span>
                <span class="s">"water"</span><span class="p">:</span> <span class="s">"Ocean waves crashing on a rocky shore with water rushing and receding"</span><span class="p">,</span>
                <span class="s">"fire"</span><span class="p">:</span> <span class="s">"Campfire crackling with wood popping and flames hissing"</span>
            <span class="p">},</span>
            <span class="s">"urban"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"traffic"</span><span class="p">:</span> <span class="s">"Busy intersection with cars honking, engines revving, and traffic signals beeping"</span><span class="p">,</span>
                <span class="s">"cafe"</span><span class="p">:</span> <span class="s">"Cafe ambience with conversations, espresso machine, and clinking cups and plates"</span><span class="p">,</span>
                <span class="s">"construction"</span><span class="p">:</span> <span class="s">"Construction site with jackhammers, power drills, and workers shouting"</span><span class="p">,</span>
                <span class="s">"park"</span><span class="p">:</span> <span class="s">"City park with children playing, ducks quacking, and people walking on gravel paths"</span>
            <span class="p">},</span>
            <span class="s">"domestic"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"kitchen"</span><span class="p">:</span> <span class="s">"Kitchen with chopping vegetables, boiling water, and refrigerator humming"</span><span class="p">,</span>
                <span class="s">"bathroom"</span><span class="p">:</span> <span class="s">"Bathroom with shower running, water hitting tiles, and fan humming"</span><span class="p">,</span>
                <span class="s">"living_room"</span><span class="p">:</span> <span class="s">"Living room with television playing, clock ticking, and occasional footsteps"</span><span class="p">,</span>
                <span class="s">"yard"</span><span class="p">:</span> <span class="s">"Backyard with lawnmower running, birds chirping, and sprinkler spraying water"</span>
            <span class="p">},</span>
            <span class="s">"animals"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"birds"</span><span class="p">:</span> <span class="s">"Dawn chorus with various birds chirping, calling, and flying between trees"</span><span class="p">,</span>
                <span class="s">"dogs"</span><span class="p">:</span> <span class="s">"Several dogs barking, whining, and playing with squeaky toys"</span><span class="p">,</span>
                <span class="s">"cats"</span><span class="p">:</span> <span class="s">"Cats purring, meowing, and scratching furniture"</span><span class="p">,</span>
                <span class="s">"insects"</span><span class="p">:</span> <span class="s">"Summer evening with crickets chirping, mosquitoes buzzing, and cicadas humming"</span>
            <span class="p">},</span>
            <span class="s">"mechanical"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"engines"</span><span class="p">:</span> <span class="s">"Car engine starting, idling, and revving with exhaust sounds"</span><span class="p">,</span>
                <span class="s">"tools"</span><span class="p">:</span> <span class="s">"Workshop with power drill, circular saw, and hammering on wood"</span><span class="p">,</span>
                <span class="s">"machinery"</span><span class="p">:</span> <span class="s">"Factory with heavy machinery, conveyor belts, and hydraulic presses"</span><span class="p">,</span>
                <span class="s">"appliances"</span><span class="p">:</span> <span class="s">"Home appliances with washing machine, vacuum cleaner, and microwave beeping"</span>
            <span class="p">},</span>
            <span class="s">"abstract"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"ui"</span><span class="p">:</span> <span class="s">"Collection of user interface sounds - notifications, alerts, and confirmation tones"</span><span class="p">,</span>
                <span class="s">"sci_fi"</span><span class="p">:</span> <span class="s">"Futuristic spacecraft with energy weapons firing, shields humming, and alarms blaring"</span><span class="p">,</span>
                <span class="s">"magic"</span><span class="p">:</span> <span class="s">"Magical spells being cast with energy building, releasing, and dissipating"</span><span class="p">,</span>
                <span class="s">"horror"</span><span class="p">:</span> <span class="s">"Creepy atmosphere with distant whispers, creaking doors, and ghostly moans"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1"># Load the model
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Loading AudioGen </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model..."</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">AudioGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">explore_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category_name</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s">"""
        Generate sound examples for all prompts in a specific category.
        
        Args:
            category_name (str): Category to explore (must be in self.categories)
            duration (float): Duration for each generated sound
            output_dir (str): Directory to save outputs (defaults to category name)
            
        Returns:
            dict: Information about generated sounds
        """</span>
        <span class="k">if</span> <span class="n">category_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">categories</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Unknown category: </span><span class="si">{</span><span class="n">category_name</span><span class="si">}</span><span class="s">. Available categories: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">categories</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Create output directory
</span>        <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">output_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">category_name</span><span class="si">}</span><span class="s">_sounds"</span>
        
        <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1"># Set generation parameters
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
            <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>
        
        <span class="c1"># Generate samples for each prompt in the category
</span>        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">prompts</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">categories</span><span class="p">[</span><span class="n">category_name</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">sound_name</span><span class="p">,</span> <span class="n">prompt</span> <span class="ow">in</span> <span class="n">prompts</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generating </span><span class="si">{</span><span class="n">category_name</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">sound_name</span><span class="si">}</span><span class="s">..."</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Prompt: '</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">'"</span><span class="p">)</span>
            
            <span class="c1"># Time the generation
</span>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
            
            <span class="c1"># Generate the sound
</span>            <span class="n">wav</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>
            
            <span class="c1"># Calculate generation time
</span>            <span class="n">generation_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            
            <span class="c1"># Save the audio
</span>            <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">sound_name</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="n">audio_write</span><span class="p">(</span>
                <span class="n">output_path</span><span class="p">,</span>
                <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">(),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>
                <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span>
            <span class="p">)</span>
            
            <span class="c1"># Store result information
</span>            <span class="n">results</span><span class="p">[</span><span class="n">sound_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">"prompt"</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span>
                <span class="s">"output_file"</span><span class="p">:</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">,</span>
                <span class="s">"generation_time"</span><span class="p">:</span> <span class="n">generation_time</span>
            <span class="p">}</span>
            
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generated in </span><span class="si">{</span><span class="n">generation_time</span><span class="p">:.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">s, saved to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        
        <span class="c1"># Create a README with category information
</span>        <span class="n">readme_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s">"README.txt"</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readme_path</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">category_name</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s"> SOUND EXAMPLES</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"="</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">category_name</span><span class="p">)</span> <span class="o">+</span> <span class="mi">14</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Generated sound examples for the following prompts:</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">sound_name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">results</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">sound_name</span><span class="si">}</span><span class="s">:</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Prompt: </span><span class="se">\"</span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s">'prompt'</span><span class="p">]</span><span class="si">}</span><span class="se">\"\n</span><span class="s">"</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"  File: </span><span class="si">{</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">basename</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s">'output_file'</span><span class="p">])</span><span class="si">}</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"All sounds generated using AudioGen </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"Duration: </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s"> seconds</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Category exploration complete! All results saved to </span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results</span>
    
    <span class="k">def</span> <span class="nf">explore_all_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">base_output_dir</span><span class="o">=</span><span class="s">"sound_categories"</span><span class="p">):</span>
        <span class="s">"""
        Generate examples for all sound categories.
        
        Args:
            duration (float): Duration for each generated sound
            base_output_dir (str): Base directory to save all categories
            
        Returns:
            dict: Information about all generated sounds
        """</span>
        <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">base_output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="n">all_results</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">category_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">categories</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Exploring category: </span><span class="si">{</span><span class="n">category_name</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            
            <span class="c1"># Create category-specific output directory
</span>            <span class="n">category_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_output_dir</span><span class="p">,</span> <span class="n">category_name</span><span class="p">)</span>
            
            <span class="c1"># Generate this category's sounds
</span>            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">explore_category</span><span class="p">(</span>
                <span class="n">category_name</span><span class="o">=</span><span class="n">category_name</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
                <span class="n">output_dir</span><span class="o">=</span><span class="n">category_dir</span>
            <span class="p">)</span>
            
            <span class="n">all_results</span><span class="p">[</span><span class="n">category_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span>
        
        <span class="c1"># Create a main README
</span>        <span class="n">readme_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_output_dir</span><span class="p">,</span> <span class="s">"README.txt"</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readme_path</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"AUDIOGEN SOUND CATEGORY EXPLORATION</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"=================================</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"This directory contains sound examples generated using Meta's AudioGen model.</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Each subdirectory contains examples from a different sound category.</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Categories included:</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">categories</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"- </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">categories</span><span class="p">[</span><span class="n">category</span><span class="p">])</span><span class="si">}</span><span class="s"> examples</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">All sounds generated using the </span><span class="si">{</span><span class="bp">self</span><span class="p">.</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model with </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s">s duration.</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Exploration of all categories complete!"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generated </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span> <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">categories</span><span class="p">.</span><span class="n">values</span><span class="p">())</span><span class="si">}</span><span class="s"> sound examples"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Results saved to </span><span class="si">{</span><span class="n">base_output_dir</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">all_results</span>

<span class="c1"># Usage example
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">explorer</span> <span class="o">=</span> <span class="n">SoundCategoryExplorer</span><span class="p">(</span><span class="n">model_size</span><span class="o">=</span><span class="s">"medium"</span><span class="p">)</span>
    
    <span class="c1"># Explore a single category
</span>    <span class="c1"># explorer.explore_category("natural", duration=5.0)
</span>    
    <span class="c1"># Or explore all categories
</span>    <span class="n">explorer</span><span class="p">.</span><span class="n">explore_all_categories</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
</code></pre></div></div>

<p>This explorer provides a structured way to experiment with different sound categories and understand AudioGen’s capabilities. It generates examples for each category, organizes them in separate directories, and creates helpful README files.</p>

<h2 id="creating-layered-soundscapes">Creating Layered Soundscapes</h2>

<p>One of AudioGen’s most powerful applications is creating layered soundscapes by combining multiple individual sounds. This approach gives you greater control over the final composition and allows you to create more complex audio environments.</p>

<p>Let’s implement a soundscape composer:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># soundscape_composer.py
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchaudio</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">AudioGen</span>
<span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>

<span class="k">class</span> <span class="nc">SoundscapeComposer</span><span class="p">:</span>
    <span class="s">"""
    Tool for creating layered soundscapes from multiple AudioGen-generated elements.
    
    This class provides functionality to generate multiple sound elements
    and combine them with fine-grained control over mixing, timing, and effects.
    """</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_size</span><span class="o">=</span><span class="s">"medium"</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="s">"""Initialize the composer with a specific model size."""</span>
        <span class="c1"># Determine device automatically if not specified
</span>        <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Using MPS (Metal) for generation"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Using CUDA for generation"</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Using CPU for generation (this will be slow)"</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="p">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">model_size</span> <span class="o">=</span> <span class="n">model_size</span>
        
        <span class="c1"># Load the model
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Loading AudioGen </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model..."</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">AudioGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        
        <span class="c1"># Store sample rate for later use
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span>
        
        <span class="c1"># Track generated elements
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">elements</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">generate_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="s">"""
        Generate a single sound element.
        
        Args:
            name (str): Name for this sound element
            prompt (str): Description of the sound to generate
            duration (float): Duration in seconds
            temperature (float): Generation temperature
            
        Returns:
            torch.Tensor: Generated audio tensor
        """</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generating sound element '</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">'..."</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Prompt: '</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">'"</span><span class="p">)</span>
        
        <span class="c1"># Set generation parameters
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
            <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="p">)</span>
        
        <span class="c1"># Generate the sound
</span>        <span class="n">wav</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>
        
        <span class="c1"># Get the audio tensor and move to CPU
</span>        <span class="n">audio_tensor</span> <span class="o">=</span> <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">()</span>
        
        <span class="c1"># Store the element
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"prompt"</span><span class="p">:</span> <span class="n">prompt</span><span class="p">,</span>
            <span class="s">"duration"</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span>
            <span class="s">"temperature"</span><span class="p">:</span> <span class="n">temperature</span><span class="p">,</span>
            <span class="s">"audio"</span><span class="p">:</span> <span class="n">audio_tensor</span><span class="p">,</span>
            <span class="s">"sample_rate"</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">sample_rate</span>
        <span class="p">}</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generated </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s">s sound element: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">audio_tensor</span>
    
    <span class="k">def</span> <span class="nf">save_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s">"soundscape_elements"</span><span class="p">):</span>
        <span class="s">"""
        Save a generated sound element to disk.
        
        Args:
            name (str): Name of the element to save
            output_dir (str): Directory to save the element
            
        Returns:
            str: Path to the saved file
        """</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">elements</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Element '</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">' not found. Generate it first."</span><span class="p">)</span>
        
        <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        
        <span class="c1"># Save the audio
</span>        <span class="n">audio_write</span><span class="p">(</span>
            <span class="n">output_path</span><span class="p">,</span>
            <span class="n">element</span><span class="p">[</span><span class="s">"audio"</span><span class="p">],</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>
            <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span>
        <span class="p">)</span>
        
        <span class="n">element</span><span class="p">[</span><span class="s">"file_path"</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Saved element '</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">' to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">element</span><span class="p">[</span><span class="s">"file_path"</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">create_soundscape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">volumes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s">"soundscape.wav"</span><span class="p">):</span>
        <span class="s">"""
        Mix multiple sound elements into a soundscape.
        
        Args:
            elements (list): List of element names to include (uses all if None)
            volumes (dict): Dictionary mapping element names to volume levels (0.0-1.0)
            output_path (str): Path to save the final soundscape
            
        Returns:
            str: Path to the saved soundscape
        """</span>
        <span class="c1"># Use all elements if none specified
</span>        <span class="k">if</span> <span class="n">elements</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">elements</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span>
        
        <span class="c1"># Verify elements exist
</span>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">elements</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s">"Element '</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">' not found. Generate it first."</span><span class="p">)</span>
        
        <span class="c1"># Default to equal volumes if not specified
</span>        <span class="k">if</span> <span class="n">volumes</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">volumes</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="mf">1.0</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">}</span>
        
        <span class="c1"># Ensure all elements have volume settings
</span>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">volumes</span><span class="p">:</span>
                <span class="n">volumes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Creating soundscape with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span><span class="si">}</span><span class="s"> elements:"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"- </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s"> (volume: </span><span class="si">{</span><span class="n">volumes</span><span class="p">[</span><span class="n">name</span><span class="p">]:.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
        
        <span class="c1"># Find the longest element
</span>        <span class="n">max_length</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">"audio"</span><span class="p">].</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">)</span>
        
        <span class="c1"># Create empty output array
</span>        <span class="n">soundscape</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">max_length</span><span class="p">)</span>
        
        <span class="c1"># Mix elements
</span>        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">audio</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="s">"audio"</span><span class="p">]</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="n">volumes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            
            <span class="c1"># Apply volume and add to soundscape (up to element length)
</span>            <span class="n">soundscape</span><span class="p">[:</span><span class="n">audio</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">audio</span> <span class="o">*</span> <span class="n">volume</span>
        
        <span class="c1"># Normalize if needed to prevent clipping
</span>        <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">soundscape</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">soundscape</span> <span class="o">=</span> <span class="n">soundscape</span> <span class="o">/</span> <span class="n">torch</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">soundscape</span><span class="p">))</span>
        
        <span class="c1"># Save the soundscape
</span>        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_dir</span><span class="p">:</span>
            <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="n">torchaudio</span><span class="p">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">output_path</span><span class="p">,</span>
            <span class="n">soundscape</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>  <span class="c1"># Add channel dimension
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">sample_rate</span>
        <span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Soundscape saved to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_path</span>
    
    <span class="k">def</span> <span class="nf">create_scene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scene_description</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s">"scenes"</span><span class="p">):</span>
        <span class="s">"""
        Create a complete audio scene from a structured description.
        
        Args:
            scene_description (dict): Dictionary containing:
                - name: Scene name
                - elements: Dictionary mapping element names to prompts
                - volumes: Dictionary mapping element names to volumes
                - durations: Dictionary mapping element names to durations
            output_dir (str): Directory to save scene files
            
        Returns:
            str: Path to the final scene audio file
        """</span>
        <span class="n">scene_name</span> <span class="o">=</span> <span class="n">scene_description</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"name"</span><span class="p">,</span> <span class="s">"unnamed_scene"</span><span class="p">)</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="n">scene_description</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"elements"</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">volumes</span> <span class="o">=</span> <span class="n">scene_description</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"volumes"</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">durations</span> <span class="o">=</span> <span class="n">scene_description</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"durations"</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">temperatures</span> <span class="o">=</span> <span class="n">scene_description</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"temperatures"</span><span class="p">,</span> <span class="p">{})</span>
        
        <span class="c1"># Create scene directory
</span>        <span class="n">scene_dir</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">scene_name</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">"_"</span><span class="p">).</span><span class="n">lower</span><span class="p">())</span>
        <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">scene_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1"># Generate each element
</span>        <span class="n">element_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">prompt</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Get parameters for this element
</span>            <span class="n">duration</span> <span class="o">=</span> <span class="n">durations</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="n">temperatures</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            
            <span class="c1"># Generate the element
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">generate_element</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
                <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span>
            <span class="p">)</span>
            
            <span class="c1"># Save the individual element
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">save_element</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">scene_dir</span><span class="p">,</span> <span class="s">"elements"</span><span class="p">))</span>
            
            <span class="n">element_names</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
        <span class="c1"># Create the soundscape
</span>        <span class="n">soundscape_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">scene_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">scene_name</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">'_'</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">create_soundscape</span><span class="p">(</span>
            <span class="n">elements</span><span class="o">=</span><span class="n">element_names</span><span class="p">,</span>
            <span class="n">volumes</span><span class="o">=</span><span class="n">volumes</span><span class="p">,</span>
            <span class="n">output_path</span><span class="o">=</span><span class="n">soundscape_path</span>
        <span class="p">)</span>
        
        <span class="c1"># Create a README with scene details
</span>        <span class="n">readme_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">scene_dir</span><span class="p">,</span> <span class="s">"README.txt"</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">readme_path</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">scene_name</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"="</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">scene_name</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">"Scene elements:</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">element_names</span><span class="p">:</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">:</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Prompt: </span><span class="se">\"</span><span class="si">{</span><span class="n">elements</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="si">}</span><span class="se">\"\n</span><span class="s">"</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Duration: </span><span class="si">{</span><span class="n">durations</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span><span class="si">}</span><span class="s">s</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Volume: </span><span class="si">{</span><span class="n">volumes</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
                <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"  Temperature: </span><span class="si">{</span><span class="n">temperatures</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">):.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
            
            <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s">"Final scene audio: </span><span class="si">{</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">basename</span><span class="p">(</span><span class="n">soundscape_path</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Scene '</span><span class="si">{</span><span class="n">scene_name</span><span class="si">}</span><span class="s">' created successfully!"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Scene files saved to </span><span class="si">{</span><span class="n">scene_dir</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">soundscape_path</span>

<span class="c1"># Usage example
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">composer</span> <span class="o">=</span> <span class="n">SoundscapeComposer</span><span class="p">(</span><span class="n">model_size</span><span class="o">=</span><span class="s">"medium"</span><span class="p">)</span>
    
    <span class="c1"># Example: Create a rainy cafe scene
</span>    <span class="n">rain_cafe_scene</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"name"</span><span class="p">:</span> <span class="s">"Rainy Cafe"</span><span class="p">,</span>
        <span class="s">"elements"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"rain"</span><span class="p">:</span> <span class="s">"Heavy rain falling on windows and roof with occasional thunder"</span><span class="p">,</span>
            <span class="s">"cafe"</span><span class="p">:</span> <span class="s">"Inside cafe ambience with quiet conversations and cups clinking"</span><span class="p">,</span>
            <span class="s">"music"</span><span class="p">:</span> <span class="s">"Soft jazz music playing from speakers, muffled and in the background"</span><span class="p">,</span>
            <span class="s">"traffic"</span><span class="p">:</span> <span class="s">"Occasional traffic sounds from outside, muffled by the rain"</span>
        <span class="p">},</span>
        <span class="s">"volumes"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"rain"</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
            <span class="s">"cafe"</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="s">"music"</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="s">"traffic"</span><span class="p">:</span> <span class="mf">0.2</span>
        <span class="p">},</span>
        <span class="s">"durations"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"rain"</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span>
            <span class="s">"cafe"</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span>
            <span class="s">"music"</span><span class="p">:</span> <span class="mf">8.0</span><span class="p">,</span>
            <span class="s">"traffic"</span><span class="p">:</span> <span class="mf">8.0</span>
        <span class="p">},</span>
        <span class="s">"temperatures"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"rain"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s">"cafe"</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s">"music"</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
            <span class="s">"traffic"</span><span class="p">:</span> <span class="mf">1.2</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="n">composer</span><span class="p">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">rain_cafe_scene</span><span class="p">)</span>
</code></pre></div></div>

<p>This soundscape composer demonstrates the powerful technique of layering individual sound elements. By generating each element separately and then mixing them together, you can:</p>

<ol>
  <li>Have fine-grained control over each sound component</li>
  <li>Adjust volume levels for proper balancing</li>
  <li>Create more complex and realistic soundscapes</li>
  <li>Easily make adjustments to individual elements if needed</li>
</ol>

<h2 id="understanding-audiogens-limitations">Understanding AudioGen’s Limitations</h2>

<p>While AudioGen is a powerful tool for generating sound effects, it’s important to understand its limitations:</p>

<h3 id="1-duration-limitations">1. Duration Limitations</h3>

<p>AudioGen works best with shorter durations (3-10 seconds). Longer generations may:</p>
<ul>
  <li>Lose coherence over time</li>
  <li>Introduce unnatural repetitions</li>
  <li>Consume significantly more memory</li>
</ul>

<p><strong>Solution</strong>: For longer soundscapes, generate shorter segments and combine them using the layering techniques demonstrated above.</p>

<h3 id="2-specificity-vs-generality">2. Specificity vs. Generality</h3>

<p>Very specific prompts sometimes produce less realistic results than more general ones:</p>

<ul>
  <li><strong>Too specific</strong>: “A 1967 Ford Mustang V8 engine starting with a slight fuel injector issue on a cold morning”</li>
  <li><strong>Better</strong>: “Vintage car engine starting and idling roughly”</li>
</ul>

<p><strong>Solution</strong>: Start with more general prompts and progressively add details to find the optimal balance.</p>

<h3 id="3-abstract-concepts">3. Abstract Concepts</h3>

<p>AudioGen struggles with abstract or conceptual prompts:</p>

<ul>
  <li><strong>Difficult</strong>: “The sound of anxiety” or “Happy emotions”</li>
  <li><strong>Better</strong>: Describe the actual sounds you want, like “Racing heartbeat and quick breathing” or “Children laughing and playing”</li>
</ul>

<p><strong>Solution</strong>: Focus on describing concrete sounds rather than emotions or concepts.</p>

<h3 id="4-musical-elements">4. Musical Elements</h3>

<p>Although AudioGen can generate some musical elements, it’s not specialized for music:</p>

<ul>
  <li><strong>AudioGen struggles with</strong>: “Classical piano sonata with complex arpeggios”</li>
  <li><strong>Better use MusicGen for</strong>: Any structured musical content</li>
</ul>

<p><strong>Solution</strong>: Use MusicGen for musical content and AudioGen for non-musical sounds.</p>

<h3 id="5-sound-quality-issues">5. Sound Quality Issues</h3>

<p>Some common quality issues that may appear:</p>

<ul>
  <li><strong>Artifacting</strong>: Unnatural digital artifacts at high frequencies</li>
  <li><strong>Looping</strong>: Noticeable repetitions in longer generations</li>
  <li><strong>Blending</strong>: Multiple distinct sounds sometimes blend unnaturally</li>
</ul>

<p><strong>Solution</strong>: Experiment with different temperature settings, adjust prompt wording, or layer multiple generations.</p>

<h2 id="practical-applications-for-audiogen">Practical Applications for AudioGen</h2>

<p>AudioGen can be valuable in various creative and professional contexts:</p>

<h3 id="1-game-development">1. Game Development</h3>

<ul>
  <li>Environmental ambience (forests, cities, dungeons)</li>
  <li>Mechanical effects (weapons, vehicles, machinery)</li>
  <li>Interface sounds (menus, notifications, achievements)</li>
  <li>Background atmospheres (tension, peace, mystery)</li>
</ul>

<h3 id="2-video-production">2. Video Production</h3>

<ul>
  <li>Background ambience for scenes</li>
  <li>Sound effects for transitions and actions</li>
  <li>Temporary placeholder sounds during editing</li>
  <li>Creative sound design elements</li>
</ul>

<h3 id="3-podcasts-and-audio-drama">3. Podcasts and Audio Drama</h3>

<ul>
  <li>Scene-setting environmental audio</li>
  <li>Special effects for dramatic moments</li>
  <li>Ambient backgrounds to establish location</li>
  <li>Sound design elements for introductions and transitions</li>
</ul>

<h3 id="4-prototyping-and-demos">4. Prototyping and Demos</h3>

<ul>
  <li>Quick audio mockups for presentations</li>
  <li>Proof-of-concept sound design</li>
  <li>Temporary assets for early development</li>
  <li>Client previews before professional sound design</li>
</ul>

<h3 id="5-educational-resources">5. Educational Resources</h3>

<ul>
  <li>Sound examples for teaching</li>
  <li>Auditory illustrations for concepts</li>
  <li>Accessible audio resources for learning</li>
  <li>Interactive educational experiences</li>
</ul>

<h2 id="hands-on-challenge-create-a-dynamic-environment">Hands-on Challenge: Create a Dynamic Environment</h2>

<p>Now it’s your turn to apply what you’ve learned. Your challenge is to create a dynamic environment that changes over time:</p>

<ol>
  <li>Choose an environment that would have changing sounds (forest, city, etc.)</li>
  <li>Define 3-4 distinct sound elements that would be part of this environment</li>
  <li>Generate each element using appropriate prompts</li>
  <li>Mix them together with varying volumes to create the final soundscape</li>
  <li>Document your approach, challenges, and results</li>
</ol>

<p><strong>Bonus Challenge</strong>: Create two variations of your environment (e.g., “forest day” and “forest night”) by using the same basic elements but varying the prompts and mixing.</p>

<h2 id="key-takeaways">Key Takeaways</h2>

<ul>
  <li>AudioGen is specialized for generating non-musical sounds, while MusicGen is designed for music</li>
  <li>Effective AudioGen prompts focus on sound sources, environments, and sonic qualities</li>
  <li>Layering multiple sound elements creates more complex and controlled soundscapes</li>
  <li>Different sound categories require different prompt approaches</li>
  <li>Creating dynamic, evolving soundscapes often requires combining multiple techniques</li>
</ul>

<h2 id="next-steps">Next Steps</h2>

<p>Now that you understand the basics of AudioGen, you’re ready to explore more advanced techniques:</p>

<ul>
  <li><strong>Chapter 11: Sound Effect Generation Techniques</strong> - Learn specialized approaches for different sound types</li>
  <li><strong>Chapter 12: Audio Scene Composition</strong> - Create complex, multi-layered audio environments</li>
  <li><strong>Chapter 13: Sound Design Workflows</strong> - Build efficient pipelines for sound design projects</li>
</ul>

<h2 id="further-reading">Further Reading</h2>

<ul>
  <li><a href="https://github.com/facebookresearch/audiocraft">AudioCraft GitHub Repository</a></li>
  <li><a href="https://ai.meta.com/blog/audiocraft-musicgen-audiogen-encodec-generative-ai-audio/">Meta AI Blog: AudioGen Release</a></li>
  <li><a href="https://designingsound.org/2010/02/22/the-guide-to-sound-effects/">Sound Design Principles</a></li>
  <li><a href="https://arxiv.org/abs/1608.04363">Environmental Sound Classification</a></li>
  <li><a href="https://ccrma.stanford.edu/~jos/filters/">Audio Signal Processing Fundamentals</a></li>
</ul>

  
  
  
  
  
  
  
  
</div>

<div class="chapter-navigation">
  
  <a href="/chapters/part3/audio-scene-composition/" class="prev-chapter">
    <span class="nav-label">Previous</span>
    <span class="nav-title">Audio Scene Composition</span>
  </a>
  
  
  
  <a href="/chapters/part3/sound-effect-techniques/" class="next-chapter">
    <span class="nav-label">Next</span>
    <span class="nav-title">Sound Effect Generation Techniques</span>
  </a>
  
</div>

<!-- Copyright footer for all chapter pages -->
<div class="copyright-footer">
  <hr>
  <p>
    Copyright © 2025 Scott Friedman.
    <br>
    This work is licensed under the <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.
  </p>
</div>


        </div>
      </main>

      <footer class="site-footer">
        <div class="container">
          <div class="footer-col-wrapper">
            <div class="footer-col">
              <p>A hands-on guide to creating music, sound effects, and audio experiences with AI</p>
              <p>
                <a href="https://github.com/facebookresearch/audiocraft">AudioCraft GitHub Repository</a>
              </p>
            </div>
            <div class="footer-col">
              <p class="copyright">
                Copyright © 2025 Scott Friedman.<br>
                Licensed under <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a>.
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </body>
</html>