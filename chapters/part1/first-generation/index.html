<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chapter 4: Your First Audio Generation</title>
  <meta name="description" content="Chapter 4: Your First Audio Generation">
  <link rel="canonical" href="https://scttfrdmn.github.io/practical-meta-audiocraft/chapters/part1/first-generation/">
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      margin: 0;
      padding: 0;
    }
    .wrapper {
      max-width: 100%;
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 0 20px;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    h1 { color: #1a73e8; }
    h2 { color: #34a853; }
    a {
      color: #1a73e8;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .site-header {
      border-bottom: 1px solid #eee;
      padding: 15px 0;
      margin-bottom: 30px;
    }
    .site-title {
      margin: 0;
      font-size: 1.8rem;
    }
    .site-title a {
      color: #1a73e8;
      text-decoration: none;
    }
    .site-nav {
      float: right;
      margin-top: 10px;
    }
    .site-nav .page-link {
      margin-left: 20px;
    }
    .nav-trigger {
      display: none;
    }
    .menu-icon {
      display: none;
    }
    .page-content {
      padding: 20px 0;
    }
    .site-footer {
      border-top: 1px solid #eee;
      padding: 30px 0;
      margin-top: 60px;
    }
    .footer-col-wrapper {
      display: flex;
      flex-wrap: wrap;
    }
    .footer-col {
      flex: 1;
      min-width: 200px;
      padding-right: 20px;
    }
    code {
      background-color: #f5f5f5;
      padding: 2px 5px;
      border-radius: 3px;
    }
    pre {
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
    }
    .highlight {
      background-color: #f5f5f5;
      border-radius: 5px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
    }
    th {
      background-color: #f5f5f5;
      text-align: left;
    }
    button, .button {
      display: inline-block;
      background-color: #1a73e8;
      color: white !important;
      padding: 10px 20px;
      border-radius: 4px;
      font-weight: bold;
      margin-top: 20px;
      border: none;
      cursor: pointer;
      text-decoration: none !important;
    }
    button:hover, .button:hover {
      background-color: #0d65d9;
    }
    .feature {
      background-color: #f5f5f5;
      border-radius: 8px;
      padding: 20px;
      border-left: 4px solid #1a73e8;
      margin-bottom: 20px;
    }
    
    @media screen and (max-width: 600px) {
      .site-nav {
        position: absolute;
        top: 70px;
        right: 20px;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 5px;
        text-align: right;
        padding: 0;
        z-index: 1;
      }
      .site-nav .page-link {
        display: block;
        padding: 10px;
        margin: 0;
      }
      .site-nav .menu-icon {
        display: block;
        float: right;
        width: 36px;
        height: 26px;
        line-height: 0;
        padding-top: 10px;
        text-align: center;
      }
      .site-nav .trigger {
        clear: both;
        display: none;
      }
      .site-nav input:checked ~ .trigger {
        display: block;
        padding-bottom: 5px;
      }
      .footer-col-wrapper {
        flex-direction: column;
      }
      .footer-col {
        margin-bottom: 20px;
      }
    }
  </style>
</head><body>
    <div class="wrapper">
      <header class="site-header">
        <div class="container">
          <h1 class="site-title"><a href="/practical-meta-audiocraft/">Practical Meta AudioCraft</a></h1>
          <nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
              <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                  <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484c0-0.82,0.665-1.485,1.484-1.485 h15.032C17.335,0,18,0.665,18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516 c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,6.031,18,6.696,18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516c0-0.82,0.665-1.483,1.484-1.483h15.032 C17.335,12.031,18,12.696,18,13.516z"/>
                </svg>
              </span>
            </label>

            <div class="trigger">
              <a class="page-link" href="/practical-meta-audiocraft/">Home</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part1/introduction/">Getting Started</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part2/basic-music/">MusicGen</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part3/introduction-to-audiogen/">AudioGen</a>
              <a class="page-link" href="/practical-meta-audiocraft/tutorials/getting-started/">Tutorials</a>
            </div>
          </nav>
        </div>
      </header>

      <main class="page-content" aria-label="Content">
        <div class="container">
          <div class="chapter">
  <div class="chapter-header">
    <div class="chapter-metadata">
      <span class="difficulty beginner">Beginner</span>
      <span class="estimated-time">2 hours</span>
    </div>
    <h1>Chapter 4: Your First Audio Generation</h1>
  </div>
  
  
  <div class="scenario-quote">
    <blockquote>
      <p>"I've set up AudioCraft successfully, and I understand the basic concepts. Now I'm ready to actually generate some audio! I want to create a simple example that works reliably, learn how to save and play the results, and start experimenting with different prompts and settings."</p>
      <cite>— Sam Patel, Digital Media Student</cite>
    </blockquote>
  </div>
  
  
  <h1 id="chapter-4-your-first-audio-generation">Chapter 4: Your First Audio Generation</h1>

<h2 id="the-challenge">The Challenge</h2>

<p>You’ve installed AudioCraft and understand its architecture in theory, but how do you actually use it to generate audio? Creating your first successful generation requires bringing together everything we’ve learned so far: setting up the right environment, loading the appropriate model, crafting an effective prompt, configuring generation parameters, and handling the output.</p>

<p>Many beginners struggle with this first step - they may encounter errors when loading models, generate audio that doesn’t match their expectations, or be unsure how to save and play the generated content. Getting this foundational workflow right is crucial before moving on to more complex applications.</p>

<p>In this chapter, we’ll create a complete, working audio generation script, explaining each step along the way. We’ll explore both MusicGen and AudioGen to generate different types of audio, and establish a solid foundation for your future audio generation projects.</p>

<h2 id="learning-objectives">Learning Objectives</h2>

<p>By the end of this chapter, you’ll be able to:</p>

<ul>
  <li>Create a complete script for generating audio with AudioCraft</li>
  <li>Generate both music and sound effects from text descriptions</li>
  <li>Configure generation parameters for different results</li>
  <li>Save generated audio in various formats</li>
  <li>Play generated audio directly in different environments</li>
  <li>Implement basic error handling for robust generation</li>
  <li>Begin experimenting with your own prompts and settings</li>
</ul>

<h2 id="your-first-complete-generation-script">Your First Complete Generation Script</h2>

<p>Let’s dive right in with a complete script for generating music, which we’ll then break down step by step:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># first_generation.py - Your first AudioCraft generation script
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">MusicGen</span>
<span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>

<span class="k">def</span> <span class="nf">generate_music</span><span class="p">(</span>
    <span class="n">prompt</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">model_size</span><span class="o">=</span><span class="s">"small"</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s">"generated_audio"</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="bp">None</span>
<span class="p">):</span>
    <span class="s">"""
    Generate music using AudioCraft's MusicGen model.
    
    Args:
        prompt (str): Text description of the music to generate
        duration (float): Length of audio in seconds (max 30)
        model_size (str): Size of model to use ('small', 'medium', or 'large')
        output_dir (str): Directory to save the generated audio
        temperature (float): Controls randomness (0.5-1.5 recommended)
        top_k (int): Controls diversity via top-k sampling
        seed (int, optional): Random seed for reproducible generation
    
    Returns:
        str: Path to the generated audio file
    """</span>
    <span class="c1"># Create output directory if it doesn't exist
</span>    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generating music for prompt: '</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">'"</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="c1"># Set random seed if provided (for reproducibility)
</span>    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">torch</span><span class="p">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Using random seed: </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="c1"># Determine the appropriate device
</span>    <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Using CUDA for generation"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>  <span class="c1"># Apple Silicon
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Using MPS (Metal) for generation"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Using CPU for generation (this will be slower)"</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Load the model
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Loading MusicGen </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model..."</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
        <span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        
        <span class="c1"># Set generation parameters
</span>        <span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
            <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Disable nucleus sampling
</span>            <span class="n">cfg_coef</span><span class="o">=</span><span class="mf">3.0</span>  <span class="c1"># Classifier-free guidance coefficient
</span>        <span class="p">)</span>
        
        <span class="c1"># Generate the audio
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Generating audio..."</span><span class="p">)</span>
        <span class="n">wav</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>  <span class="c1"># Batch of 1 prompt
</span>        
        <span class="c1"># Create a filename based on the prompt
</span>        <span class="n">safe_prompt</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="s">"_"</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prompt</span><span class="p">)[:</span><span class="mi">30</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"music_</span><span class="si">{</span><span class="n">safe_prompt</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s">"</span>
        
        <span class="c1"># Save the audio file
</span>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">audio_write</span><span class="p">(</span>
            <span class="n">output_path</span><span class="p">,</span>          <span class="c1"># Path without extension
</span>            <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">(),</span>         <span class="c1"># First (and only) audio in batch
</span>            <span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>    <span class="c1"># Sample rate (typically 32kHz)
</span>            <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span><span class="p">,</span>  <span class="c1"># Normalize audio levels
</span>        <span class="p">)</span>
        
        <span class="n">generation_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generation completed in </span><span class="si">{</span><span class="n">generation_time</span><span class="p">:.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Audio saved to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span>
        
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error generating audio: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up to free memory
</span>        <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
            <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Example prompts to try
</span>    <span class="n">example_prompts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"An upbeat electronic dance track with a catchy melody and energetic rhythm"</span><span class="p">,</span>
        <span class="s">"A peaceful piano piece with gentle strings in the background"</span><span class="p">,</span>
        <span class="s">"A rock anthem with powerful electric guitar and driving drums"</span><span class="p">,</span>
        <span class="s">"A jazz fusion track with complex chord progressions and saxophone solo"</span><span class="p">,</span>
        <span class="s">"An ambient soundscape with ethereal pads and subtle textures"</span>
    <span class="p">]</span>
    
    <span class="c1"># Choose the first prompt (change the index to try different prompts)
</span>    <span class="n">prompt_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">chosen_prompt</span> <span class="o">=</span> <span class="n">example_prompts</span><span class="p">[</span><span class="n">prompt_index</span><span class="p">]</span>
    
    <span class="c1"># Generate music with the chosen prompt
</span>    <span class="n">output_file</span> <span class="o">=</span> <span class="n">generate_music</span><span class="p">(</span>
        <span class="n">prompt</span><span class="o">=</span><span class="n">chosen_prompt</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>  <span class="c1"># 10 seconds
</span>        <span class="n">model_size</span><span class="o">=</span><span class="s">"small"</span><span class="p">,</span>  <span class="c1"># Use "small", "medium", or "large"
</span>        <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span>  <span class="c1"># Standard creativity level
</span>    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Success! Generated audio saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Provide instructions for playing the audio
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">To play the generated audio:"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"1. Use a media player to open the WAV file"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"2. Or in Python, you can use:"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"   from IPython.display import Audio"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"   Audio(filename='</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s">')"</span><span class="p">)</span>
</code></pre></div></div>

<p>Save this script as <code class="language-plaintext highlighter-rouge">first_generation.py</code> and run it from your command line:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python first_generation.py
</code></pre></div></div>

<p>If everything is set up correctly, it will generate a 10-second music clip based on the first example prompt and save it to the <code class="language-plaintext highlighter-rouge">generated_audio</code> directory.</p>

<h2 id="breaking-down-the-script">Breaking Down the Script</h2>

<p>Let’s understand each component of our generation script:</p>

<h3 id="1-imports-and-dependencies">1. Imports and Dependencies</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">MusicGen</span>
<span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>
</code></pre></div></div>

<p>These imports provide:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">torch</code>: PyTorch for tensor operations and device management</li>
  <li><code class="language-plaintext highlighter-rouge">os</code>: Operating system utilities for file handling</li>
  <li><code class="language-plaintext highlighter-rouge">time</code>: Time measurement for performance tracking</li>
  <li><code class="language-plaintext highlighter-rouge">MusicGen</code>: The music generation model from AudioCraft</li>
  <li><code class="language-plaintext highlighter-rouge">audio_write</code>: Utility for saving audio files with proper formatting</li>
</ul>

<h3 id="2-the-main-generation-function">2. The Main Generation Function</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">generate_music</span><span class="p">(</span>
    <span class="n">prompt</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">model_size</span><span class="o">=</span><span class="s">"small"</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s">"generated_audio"</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="bp">None</span>
<span class="p">):</span>
</code></pre></div></div>

<p>This function encapsulates the complete generation process with configurable parameters:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">prompt</code>: Text description of the music to generate</li>
  <li><code class="language-plaintext highlighter-rouge">duration</code>: Length in seconds (max 30 seconds per generation)</li>
  <li><code class="language-plaintext highlighter-rouge">model_size</code>: Model size (‘small’, ‘medium’, or ‘large’)</li>
  <li><code class="language-plaintext highlighter-rouge">output_dir</code>: Directory to save generated audio</li>
  <li><code class="language-plaintext highlighter-rouge">temperature</code>: Controls randomness/creativity</li>
  <li><code class="language-plaintext highlighter-rouge">top_k</code>: Controls diversity via top-k sampling</li>
  <li><code class="language-plaintext highlighter-rouge">seed</code>: Optional random seed for reproducible results</li>
</ul>

<h3 id="3-device-selection">3. Device Selection</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Determine the appropriate device
</span><span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Using CUDA for generation"</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>  <span class="c1"># Apple Silicon
</span>    <span class="k">print</span><span class="p">(</span><span class="s">"Using MPS (Metal) for generation"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Using CPU for generation (this will be slower)"</span><span class="p">)</span>
</code></pre></div></div>

<p>This code automatically selects the best available hardware:</p>
<ul>
  <li>NVIDIA GPUs with CUDA</li>
  <li>Apple Silicon with Metal</li>
  <li>CPU as a fallback</li>
</ul>

<p>The device selection is critical for performance - generation can be 10-20x faster on GPUs compared to CPUs.</p>

<h3 id="4-loading-the-model">4. Loading the Model</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load the model
</span><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Loading MusicGen </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model..."</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</code></pre></div></div>

<p>This loads the pre-trained model of the specified size and moves it to the appropriate device. The first time you run this, it will download the model weights from the internet.</p>

<h3 id="5-setting-generation-parameters">5. Setting Generation Parameters</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set generation parameters
</span><span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
    <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
    <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span><span class="p">,</span>
    <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Disable nucleus sampling
</span>    <span class="n">cfg_coef</span><span class="o">=</span><span class="mf">3.0</span>  <span class="c1"># Classifier-free guidance coefficient
</span><span class="p">)</span>
</code></pre></div></div>

<p>These parameters control the generation process:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">duration</code>: Length of audio to generate</li>
  <li><code class="language-plaintext highlighter-rouge">temperature</code>: Randomness in the generation (higher = more random)</li>
  <li><code class="language-plaintext highlighter-rouge">top_k</code>: Number of most likely tokens to consider</li>
  <li><code class="language-plaintext highlighter-rouge">top_p</code>: Nucleus sampling threshold (0.0 disables it)</li>
  <li><code class="language-plaintext highlighter-rouge">cfg_coef</code>: How closely to follow the text prompt</li>
</ul>

<h3 id="6-generating-the-audio">6. Generating the Audio</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Generate the audio
</span><span class="k">print</span><span class="p">(</span><span class="s">"Generating audio..."</span><span class="p">)</span>
<span class="n">wav</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>  <span class="c1"># Batch of 1 prompt
</span></code></pre></div></div>

<p>This is where the magic happens! The model takes our prompt and generates audio that matches the description. Note that <code class="language-plaintext highlighter-rouge">generate()</code> expects a list of prompts, even if we’re only using one.</p>

<h3 id="7-saving-the-output">7. Saving the Output</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a filename based on the prompt
</span><span class="n">safe_prompt</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="s">"_"</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prompt</span><span class="p">)[:</span><span class="mi">30</span><span class="p">]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"music_</span><span class="si">{</span><span class="n">safe_prompt</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s">"</span>

<span class="c1"># Save the audio file
</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">audio_write</span><span class="p">(</span>
    <span class="n">output_path</span><span class="p">,</span>          <span class="c1"># Path without extension
</span>    <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">(),</span>         <span class="c1"># First (and only) audio in batch
</span>    <span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>    <span class="c1"># Sample rate (typically 32kHz)
</span>    <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span><span class="p">,</span>  <span class="c1"># Normalize audio levels
</span><span class="p">)</span>
</code></pre></div></div>

<p>This code:</p>
<ol>
  <li>Creates a safe filename from the prompt (removing special characters)</li>
  <li>Uses <code class="language-plaintext highlighter-rouge">audio_write()</code> to save the audio as a WAV file</li>
  <li>Moves the tensor from GPU to CPU before saving</li>
  <li>Uses loudness normalization for consistent volume</li>
</ol>

<h3 id="8-memory-management">8. Memory Management</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">finally</span><span class="p">:</span>
    <span class="c1"># Clean up to free memory
</span>    <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>
</code></pre></div></div>

<p>This cleanup step is important to free GPU memory after generation, especially if you’re running multiple generations or working with limited resources.</p>

<h2 id="your-first-sound-effect-generation">Your First Sound Effect Generation</h2>

<p>Now let’s adapt our script to generate sound effects with AudioGen:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># first_sound_effect.py - Generate sound effects with AudioGen
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">AudioGen</span>  <span class="c1"># Changed from MusicGen
</span><span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>

<span class="k">def</span> <span class="nf">generate_sound_effect</span><span class="p">(</span>
    <span class="n">prompt</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">model_size</span><span class="o">=</span><span class="s">"medium"</span><span class="p">,</span>  <span class="c1"># AudioGen only has 'medium' and 'large'
</span>    <span class="n">output_dir</span><span class="o">=</span><span class="s">"generated_audio"</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="bp">None</span>
<span class="p">):</span>
    <span class="s">"""
    Generate sound effects using AudioCraft's AudioGen model.
    
    Args:
        prompt (str): Text description of the sound to generate
        duration (float): Length of audio in seconds (max 30)
        model_size (str): Size of model to use ('medium' or 'large')
        output_dir (str): Directory to save the generated audio
        temperature (float): Controls randomness (0.5-1.5 recommended)
        top_k (int): Controls diversity via top-k sampling
        seed (int, optional): Random seed for reproducible generation
    
    Returns:
        str: Path to the generated audio file
    """</span>
    <span class="c1"># Create output directory if it doesn't exist
</span>    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generating sound effect for prompt: '</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">'"</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="c1"># Set random seed if provided (for reproducibility)
</span>    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">torch</span><span class="p">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Using random seed: </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="c1"># Determine the appropriate device
</span>    <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Using CUDA for generation"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>  <span class="c1"># Apple Silicon
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Using MPS (Metal) for generation"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Using CPU for generation (this will be slower)"</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Load the model
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Loading AudioGen </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model..."</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">AudioGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
        <span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        
        <span class="c1"># Set generation parameters
</span>        <span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
            <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Disable nucleus sampling
</span>            <span class="n">cfg_coef</span><span class="o">=</span><span class="mf">3.0</span>  <span class="c1"># Classifier-free guidance coefficient
</span>        <span class="p">)</span>
        
        <span class="c1"># Generate the audio
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Generating audio..."</span><span class="p">)</span>
        <span class="n">wav</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>  <span class="c1"># Batch of 1 prompt
</span>        
        <span class="c1"># Create a filename based on the prompt
</span>        <span class="n">safe_prompt</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="s">"_"</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prompt</span><span class="p">)[:</span><span class="mi">30</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"sound_</span><span class="si">{</span><span class="n">safe_prompt</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s">"</span>
        
        <span class="c1"># Save the audio file
</span>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">audio_write</span><span class="p">(</span>
            <span class="n">output_path</span><span class="p">,</span>          <span class="c1"># Path without extension
</span>            <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">(),</span>         <span class="c1"># First (and only) audio in batch
</span>            <span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>    <span class="c1"># Sample rate (typically 32kHz)
</span>            <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span><span class="p">,</span>  <span class="c1"># Normalize audio levels
</span>        <span class="p">)</span>
        
        <span class="n">generation_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generation completed in </span><span class="si">{</span><span class="n">generation_time</span><span class="p">:.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Audio saved to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span>
        
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error generating audio: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up to free memory
</span>        <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
            <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Example prompts to try - tailored for sound effects
</span>    <span class="n">example_prompts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"Heavy rain falling on a metal roof with occasional thunder in the distance"</span><span class="p">,</span>
        <span class="s">"Crackling campfire with wood popping and occasional owl hoots"</span><span class="p">,</span>
        <span class="s">"Busy city street with cars passing, people talking, and sirens in the distance"</span><span class="p">,</span>
        <span class="s">"Forest ambience with birds chirping, leaves rustling, and a stream flowing"</span><span class="p">,</span>
        <span class="s">"Old mechanical clock ticking with gears turning and a soft bell chime"</span>
    <span class="p">]</span>
    
    <span class="c1"># Choose the first prompt (change the index to try different prompts)
</span>    <span class="n">prompt_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">chosen_prompt</span> <span class="o">=</span> <span class="n">example_prompts</span><span class="p">[</span><span class="n">prompt_index</span><span class="p">]</span>
    
    <span class="c1"># Generate sound effect with the chosen prompt
</span>    <span class="n">output_file</span> <span class="o">=</span> <span class="n">generate_sound_effect</span><span class="p">(</span>
        <span class="n">prompt</span><span class="o">=</span><span class="n">chosen_prompt</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>  <span class="c1"># 5 seconds
</span>        <span class="n">model_size</span><span class="o">=</span><span class="s">"medium"</span><span class="p">,</span>  <span class="c1"># Use "medium" or "large"
</span>        <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span>  <span class="c1"># Standard creativity level
</span>    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Success! Generated audio saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<p>The key differences in this script are:</p>
<ol>
  <li>We import <code class="language-plaintext highlighter-rouge">AudioGen</code> instead of <code class="language-plaintext highlighter-rouge">MusicGen</code></li>
  <li>AudioGen only offers ‘medium’ and ‘large’ model sizes (no ‘small’)</li>
  <li>Default duration is shorter (5s vs 10s) as sound effects are often briefer</li>
  <li>Example prompts are focused on sound effects rather than music</li>
  <li>Filename prefix is ‘sound_’ instead of ‘music_’</li>
</ol>

<p>Save this as <code class="language-plaintext highlighter-rouge">first_sound_effect.py</code> and run it to generate your first sound effect.</p>

<h2 id="playing-generated-audio">Playing Generated Audio</h2>

<p>Once you’ve generated audio, you’ll want to listen to it. Here are several methods for playing your generated audio:</p>

<h3 id="1-using-external-media-players">1. Using External Media Players</h3>

<p>The simplest approach is to open the generated WAV file with your system’s media player:</p>
<ul>
  <li>Windows: Windows Media Player, VLC</li>
  <li>macOS: QuickTime, VLC</li>
  <li>Linux: VLC, mpv, etc.</li>
</ul>

<h3 id="2-playing-audio-in-python-scripts">2. Playing Audio in Python Scripts</h3>

<p>You can add audio playback directly to your scripts using libraries like <code class="language-plaintext highlighter-rouge">playsound</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Install with: pip install playsound
</span><span class="kn">from</span> <span class="nn">playsound</span> <span class="kn">import</span> <span class="n">playsound</span>

<span class="c1"># After generating audio
</span><span class="n">playsound</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="3-playing-audio-in-jupyter-notebooks">3. Playing Audio in Jupyter Notebooks</h3>

<p>For Jupyter notebook users, IPython provides a convenient Audio widget:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Audio</span>

<span class="c1"># After generating audio
</span><span class="n">Audio</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
</code></pre></div></div>

<p>This creates an interactive audio player directly in your notebook.</p>

<h3 id="4-creating-a-simple-playback-script">4. Creating a Simple Playback Script</h3>

<p>Here’s a utility script to play any audio file:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># play_audio.py - Simple audio player for generated files
</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">playsound</span> <span class="kn">import</span> <span class="n">playsound</span>

<span class="k">def</span> <span class="nf">play_audio</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="s">"""Play an audio file."""</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error: File </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s"> not found."</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Playing </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s">..."</span><span class="p">)</span>
    <span class="n">playsound</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Playback complete."</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">"Play audio files"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"file"</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"Path to the audio file to play"</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>
    
    <span class="n">play_audio</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="nb">file</span><span class="p">)</span>
</code></pre></div></div>

<p>Use it like this: <code class="language-plaintext highlighter-rouge">python play_audio.py generated_audio/your_file.wav</code></p>

<h2 id="customizing-your-generations">Customizing Your Generations</h2>

<p>Now that you have the basic generation working, let’s explore how to customize your results by adjusting parameters and prompts.</p>

<h3 id="adjusting-generation-parameters">Adjusting Generation Parameters</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Parameter experimentation example
</span><span class="k">def</span> <span class="nf">explore_parameters</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s">"parameter_exploration"</span><span class="p">):</span>
    <span class="s">"""Generate variations of audio using different parameters."""</span>
    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1"># Template for parameter description
</span>    <span class="k">def</span> <span class="nf">param_name</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">topk</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s">"temp</span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s">_topk</span><span class="si">{</span><span class="n">topk</span><span class="si">}</span><span class="s">"</span>
    
    <span class="c1"># List of parameters to try
</span>    <span class="n">temperatures</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
    <span class="n">top_ks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
    
    <span class="c1"># Generate with each parameter combination
</span>    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">temperatures</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">topk</span> <span class="ow">in</span> <span class="n">top_ks</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Generating with temperature=</span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s">, top_k=</span><span class="si">{</span><span class="n">topk</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">generate_music</span><span class="p">(</span>
                <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
                <span class="n">temperature</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span>
                <span class="n">top_k</span><span class="o">=</span><span class="n">topk</span><span class="p">,</span>
                <span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">,</span>
                <span class="c1"># Use parameter values in filename
</span>                <span class="n">filename_prefix</span><span class="o">=</span><span class="n">param_name</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">topk</span><span class="p">)</span>
            <span class="p">)</span>
            
            <span class="n">results</span><span class="p">[</span><span class="n">param_name</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">topk</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output_file</span>
            
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></div>

<p>This function generates audio with different temperature and top-k combinations, allowing you to compare how parameters affect the output.</p>

<h3 id="experiment-with-different-prompts">Experiment with Different Prompts</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Prompt experimentation example
</span><span class="k">def</span> <span class="nf">explore_prompts</span><span class="p">(</span><span class="n">prompts</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s">"prompt_exploration"</span><span class="p">):</span>
    <span class="s">"""Generate audio using different variations of a base prompt."""</span>
    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prompt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">prompts</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Prompt </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">prompts</span><span class="p">)</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="n">output_file</span> <span class="o">=</span> <span class="n">generate_music</span><span class="p">(</span>
            <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
            <span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">,</span>
            <span class="c1"># Use consistent parameters
</span>            <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
            <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span>
        <span class="p">)</span>
        
        <span class="n">results</span><span class="p">[</span><span class="sa">f</span><span class="s">"prompt_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_file</span>
    
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></div>

<p>This function lets you compare how different prompt formulations affect the generated audio.</p>

<h2 id="creating-a-unified-generator">Creating a Unified Generator</h2>

<p>Let’s create a more versatile script that can generate both music and sound effects:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># unified_generator.py - Generate both music and sound effects
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">MusicGen</span><span class="p">,</span> <span class="n">AudioGen</span>
<span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>

<span class="k">def</span> <span class="nf">generate_audio</span><span class="p">(</span>
    <span class="n">prompt</span><span class="p">,</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s">"music"</span><span class="p">,</span>  <span class="c1"># "music" or "sound"
</span>    <span class="n">duration</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>  <span class="c1"># Default depends on model_type
</span>    <span class="n">model_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>  <span class="c1"># Default depends on model_type
</span>    <span class="n">output_dir</span><span class="o">=</span><span class="s">"generated_audio"</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="bp">None</span>
<span class="p">):</span>
    <span class="s">"""
    Generate audio using AudioCraft models.
    
    Args:
        prompt (str): Text description of the audio to generate
        model_type (str): Type of model to use ("music" or "sound")
        duration (float, optional): Length of audio in seconds
        model_size (str, optional): Size of model to use
        output_dir (str): Directory to save the generated audio
        temperature (float): Controls randomness (0.5-1.5 recommended)
        top_k (int): Controls diversity via top-k sampling
        seed (int, optional): Random seed for reproducible generation
    
    Returns:
        str: Path to the generated audio file
    """</span>
    <span class="c1"># Set defaults based on model_type
</span>    <span class="k">if</span> <span class="n">model_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">"music"</span><span class="p">,</span> <span class="s">"sound"</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"model_type must be 'music' or 'sound'"</span><span class="p">)</span>
    
    <span class="c1"># Default duration
</span>    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">"music"</span> <span class="k">else</span> <span class="mf">5.0</span>
    
    <span class="c1"># Default model size
</span>    <span class="k">if</span> <span class="n">model_size</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">model_size</span> <span class="o">=</span> <span class="s">"small"</span> <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">"music"</span> <span class="k">else</span> <span class="s">"medium"</span>
    
    <span class="c1"># Validate model size
</span>    <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">"music"</span> <span class="ow">and</span> <span class="n">model_size</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">"small"</span><span class="p">,</span> <span class="s">"medium"</span><span class="p">,</span> <span class="s">"large"</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"For music, model_size must be 'small', 'medium', or 'large'"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">"sound"</span> <span class="ow">and</span> <span class="n">model_size</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">"medium"</span><span class="p">,</span> <span class="s">"large"</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"For sound effects, model_size must be 'medium' or 'large'"</span><span class="p">)</span>
    
    <span class="c1"># Create output directory if it doesn't exist
</span>    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generating </span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s"> for prompt: '</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">'"</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="c1"># Set random seed if provided (for reproducibility)
</span>    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">torch</span><span class="p">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Using random seed: </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="c1"># Determine the appropriate device
</span>    <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Using CUDA for generation"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>  <span class="c1"># Apple Silicon
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Using MPS (Metal) for generation"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Using CPU for generation (this will be slower)"</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Load the appropriate model
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Loading </span><span class="si">{</span><span class="s">'MusicGen'</span> <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">'music'</span> <span class="k">else</span> <span class="s">'AudioGen'</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model..."</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">"music"</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># model_type == "sound"
</span>            <span class="n">model</span> <span class="o">=</span> <span class="n">AudioGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
            
        <span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        
        <span class="c1"># Set generation parameters
</span>        <span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
            <span class="n">top_k</span><span class="o">=</span><span class="n">top_k</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>  <span class="c1"># Disable nucleus sampling
</span>            <span class="n">cfg_coef</span><span class="o">=</span><span class="mf">3.0</span>  <span class="c1"># Classifier-free guidance coefficient
</span>        <span class="p">)</span>
        
        <span class="c1"># Generate the audio
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Generating audio..."</span><span class="p">)</span>
        <span class="n">wav</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>  <span class="c1"># Batch of 1 prompt
</span>        
        <span class="c1"># Create a filename based on the prompt
</span>        <span class="n">safe_prompt</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="s">"_"</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prompt</span><span class="p">)[:</span><span class="mi">30</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">safe_prompt</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s">"</span>
        
        <span class="c1"># Save the audio file
</span>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">audio_write</span><span class="p">(</span>
            <span class="n">output_path</span><span class="p">,</span>          <span class="c1"># Path without extension
</span>            <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">(),</span>         <span class="c1"># First (and only) audio in batch
</span>            <span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>    <span class="c1"># Sample rate (typically 32kHz)
</span>            <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span><span class="p">,</span>  <span class="c1"># Normalize audio levels
</span>        <span class="p">)</span>
        
        <span class="n">generation_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generation completed in </span><span class="si">{</span><span class="n">generation_time</span><span class="p">:.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Audio saved to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span>
        
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error generating audio: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up to free memory
</span>        <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
            <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Set up command-line argument parsing
</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">"Generate music or sound effects with AudioCraft"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--type"</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s">"music"</span><span class="p">,</span> <span class="s">"sound"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s">"music"</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">"Type of audio to generate (music or sound)"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--prompt"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">"Text description of the audio to generate"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--duration"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">"Length of audio in seconds"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--model"</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s">"small"</span><span class="p">,</span> <span class="s">"medium"</span><span class="p">,</span> <span class="s">"large"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">"Model size to use"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--temp"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">"Temperature parameter (0.5-1.5 recommended)"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--seed"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">"Random seed for reproducible generation"</span><span class="p">)</span>
    <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">"--output"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">"generated_audio"</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s">"Output directory for generated audio"</span><span class="p">)</span>
    
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">()</span>
    
    <span class="c1"># Generate audio based on command-line arguments
</span>    <span class="n">output_file</span> <span class="o">=</span> <span class="n">generate_audio</span><span class="p">(</span>
        <span class="n">prompt</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">prompt</span><span class="p">,</span>
        <span class="n">model_type</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="nb">type</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">duration</span><span class="p">,</span>
        <span class="n">model_size</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">model</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">temp</span><span class="p">,</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">seed</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="n">args</span><span class="p">.</span><span class="n">output</span>
    <span class="p">)</span>
    
    <span class="k">if</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Success! Generated audio saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<p>This unified script can be used from the command line like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Generate music</span>
python unified_generator.py <span class="nt">--type</span> music <span class="nt">--prompt</span> <span class="s2">"An upbeat electronic track with a catchy melody"</span> <span class="nt">--duration</span> 15.0 <span class="nt">--model</span> medium

<span class="c"># Generate a sound effect</span>
python unified_generator.py <span class="nt">--type</span> sound <span class="nt">--prompt</span> <span class="s2">"Heavy rain falling on a metal roof with thunder"</span> <span class="nt">--duration</span> 8.0 <span class="nt">--model</span> medium
</code></pre></div></div>

<h2 id="common-issues-and-troubleshooting">Common Issues and Troubleshooting</h2>

<p>When generating your first audio, you might encounter some common issues. Here’s how to troubleshoot them:</p>

<h3 id="out-of-memory-errors">Out of Memory Errors</h3>

<p><strong>Problem</strong>: <code class="language-plaintext highlighter-rouge">RuntimeError: CUDA out of memory</code></p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Use a smaller model:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="s">'small'</span><span class="p">)</span>  <span class="c1"># Instead of 'medium' or 'large'
</span></code></pre></div>    </div>
  </li>
  <li>Generate shorter audio:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>  <span class="c1"># Instead of longer durations
</span></code></pre></div>    </div>
  </li>
  <li>Clear cache between generations:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="slow-generation">Slow Generation</h3>

<p><strong>Problem</strong>: Generation takes a very long time.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Check if you’re actually using GPU acceleration:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Using device: </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>For first-time runs, note that model downloading adds time:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The first run includes download time
# Subsequent runs will be faster
</span></code></pre></div>    </div>
  </li>
  <li>On CPU, use the smallest model possible:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="s">'small'</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="disappointing-audio-quality">Disappointing Audio Quality</h3>

<p><strong>Problem</strong>: Generated audio doesn’t match expectations.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Improve your prompt with more details:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Instead of:
</span><span class="n">prompt</span> <span class="o">=</span> <span class="s">"Electronic music"</span>
   
<span class="c1"># Try:
</span><span class="n">prompt</span> <span class="o">=</span> <span class="s">"An upbeat electronic track with a catchy synth melody, driving bass, and energetic drum patterns"</span>
</code></pre></div>    </div>
  </li>
  <li>Try a larger model:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="s">'large'</span><span class="p">)</span>  <span class="c1"># Better quality but more resources
</span></code></pre></div>    </div>
  </li>
  <li>Experiment with temperature:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># For more varied/creative results:
</span><span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">1.3</span><span class="p">)</span>
   
<span class="c1"># For more consistent/focused results:
</span><span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="a-complete-example-interactive-audio-generation">A Complete Example: Interactive Audio Generation</h2>

<p>Let’s finish with a more interactive example that lets you experiment with different settings:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># interactive_generator.py - Interactive audio generation
</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">MusicGen</span><span class="p">,</span> <span class="n">AudioGen</span>
<span class="kn">from</span> <span class="nn">audiocraft.data.audio</span> <span class="kn">import</span> <span class="n">audio_write</span>

<span class="k">def</span> <span class="nf">generate_audio_interactive</span><span class="p">():</span>
    <span class="s">"""Run an interactive session for generating audio."""</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">=== AudioCraft Interactive Generator ===</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    
    <span class="c1"># Get model type
</span>    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">model_type</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Generate [m]usic or [s]ound effects? (m/s): "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">model_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'m'</span><span class="p">,</span> <span class="s">'music'</span><span class="p">]:</span>
            <span class="n">model_type</span> <span class="o">=</span> <span class="s">"music"</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">model_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'s'</span><span class="p">,</span> <span class="s">'sound'</span><span class="p">]:</span>
            <span class="n">model_type</span> <span class="o">=</span> <span class="s">"sound"</span>
            <span class="k">break</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Please enter 'm' for music or 's' for sound effects."</span><span class="p">)</span>
    
    <span class="c1"># Get model size
</span>    <span class="n">valid_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="s">"small"</span><span class="p">,</span> <span class="s">"medium"</span><span class="p">,</span> <span class="s">"large"</span><span class="p">]</span> <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">"music"</span> <span class="k">else</span> <span class="p">[</span><span class="s">"medium"</span><span class="p">,</span> <span class="s">"large"</span><span class="p">]</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Available model sizes for </span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="s">', '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_sizes</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        <span class="n">model_size</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s">"Model size [</span><span class="si">{</span><span class="n">valid_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s">]: "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="n">valid_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">model_size</span> <span class="ow">in</span> <span class="n">valid_sizes</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Please enter a valid model size: </span><span class="si">{</span><span class="s">', '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_sizes</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="c1"># Get prompt
</span>    <span class="n">prompt</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Enter a description of the audio to generate: "</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">prompt</span><span class="p">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Prompt cannot be empty. Please enter a description: "</span><span class="p">)</span>
    
    <span class="c1"># Get duration
</span>    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">duration_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Duration in seconds (1-30) [10]: "</span><span class="p">)</span> <span class="ow">or</span> <span class="s">"10"</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">duration_input</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">duration</span> <span class="o">&lt;=</span> <span class="mi">30</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Duration must be between 1 and 30 seconds."</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Please enter a valid number."</span><span class="p">)</span>
    
    <span class="c1"># Get temperature
</span>    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">temp_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Temperature (0.1-2.0) [1.0]: "</span><span class="p">)</span> <span class="ow">or</span> <span class="s">"1.0"</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">temperature</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">temp_input</span><span class="p">)</span>
            <span class="k">if</span> <span class="mf">0.1</span> <span class="o">&lt;=</span> <span class="n">temperature</span> <span class="o">&lt;=</span> <span class="mf">2.0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Temperature must be between 0.1 and 2.0."</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"Please enter a valid number."</span><span class="p">)</span>
    
    <span class="c1"># Ask about random seed
</span>    <span class="n">use_seed</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Use random seed for reproducibility? (y/n) [n]: "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">'y'</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">use_seed</span><span class="p">:</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">seed_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Enter seed (integer) [42]: "</span><span class="p">)</span> <span class="ow">or</span> <span class="s">"42"</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seed_input</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">"Please enter a valid integer."</span><span class="p">)</span>
    
    <span class="c1"># Set up output directory
</span>    <span class="n">output_dir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Output directory [generated_audio]: "</span><span class="p">)</span> <span class="ow">or</span> <span class="s">"generated_audio"</span>
    
    <span class="c1"># Determine the appropriate device
</span>    <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Using CUDA for generation"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"mps"</span>  <span class="c1"># Apple Silicon
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Using MPS (Metal) for generation"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">device</span> <span class="o">=</span> <span class="s">"cpu"</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Using CPU for generation (this will be slower)"</span><span class="p">)</span>
    
    <span class="c1"># Generate the audio
</span>    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Generating </span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s"> with the following parameters:"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"- Prompt: '</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s">'"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"- Model: </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"- Duration: </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s"> seconds"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"- Temperature: </span><span class="si">{</span><span class="n">temperature</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"- Seed: </span><span class="si">{</span><span class="n">seed</span> <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">'None (random)'</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"- Output directory: </span><span class="si">{</span><span class="n">output_dir</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    
    <span class="n">start</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Press Enter to start generation..."</span><span class="p">)</span>
    
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Set seed if provided
</span>        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">torch</span><span class="p">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        
        <span class="c1"># Create output directory
</span>        <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1"># Load the appropriate model
</span>        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Loading </span><span class="si">{</span><span class="s">'MusicGen'</span> <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">'music'</span> <span class="k">else</span> <span class="s">'AudioGen'</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s"> model..."</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s">"music"</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># model_type == "sound"
</span>            <span class="n">model</span> <span class="o">=</span> <span class="n">AudioGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="n">model_size</span><span class="p">)</span>
            
        <span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        
        <span class="c1"># Set generation parameters
</span>        <span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
            <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
            <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">cfg_coef</span><span class="o">=</span><span class="mf">3.0</span>
        <span class="p">)</span>
        
        <span class="c1"># Generate the audio
</span>        <span class="k">print</span><span class="p">(</span><span class="s">"Generating audio..."</span><span class="p">)</span>
        <span class="n">wav</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">generate</span><span class="p">([</span><span class="n">prompt</span><span class="p">])</span>
        
        <span class="c1"># Create a filename based on the prompt
</span>        <span class="n">safe_prompt</span> <span class="o">=</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span> <span class="k">if</span> <span class="n">c</span><span class="p">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="k">else</span> <span class="s">"_"</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">prompt</span><span class="p">)[:</span><span class="mi">30</span><span class="p">]</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%Y%m%d_%H%M%S"</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">safe_prompt</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">model_size</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s">"</span>
        
        <span class="c1"># Save the audio file
</span>        <span class="n">output_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">audio_write</span><span class="p">(</span>
            <span class="n">output_path</span><span class="p">,</span>
            <span class="n">wav</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cpu</span><span class="p">(),</span>
            <span class="n">model</span><span class="p">.</span><span class="n">sample_rate</span><span class="p">,</span>
            <span class="n">strategy</span><span class="o">=</span><span class="s">"loudness"</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="n">generation_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Generation completed in </span><span class="si">{</span><span class="n">generation_time</span><span class="p">:.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s"> seconds"</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Audio saved to </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        
        <span class="c1"># Ask about playing the audio
</span>        <span class="n">try_play</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Would you like to try playing the audio? (y/n) [y]: "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">'n'</span>
        <span class="k">if</span> <span class="n">try_play</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Try different methods to play audio
</span>                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Audio</span><span class="p">,</span> <span class="n">display</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"Playing audio with IPython..."</span><span class="p">)</span>
                    <span class="n">display</span><span class="p">(</span><span class="n">Audio</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">))</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">"If you don't hear anything, your environment may not support IPython audio playback."</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="nb">ImportError</span><span class="p">,</span> <span class="nb">TypeError</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="kn">from</span> <span class="nn">playsound</span> <span class="kn">import</span> <span class="n">playsound</span>
                        <span class="k">print</span><span class="p">(</span><span class="s">"Playing audio with playsound..."</span><span class="p">)</span>
                        <span class="n">playsound</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
                    <span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Couldn't play audio automatically."</span><span class="p">)</span>
                        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Please open the file manually: </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Error playing audio: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Please open the file manually: </span><span class="si">{</span><span class="n">output_path</span><span class="si">}</span><span class="s">.wav"</span><span class="p">)</span>
        
        <span class="c1"># Ask about generating another
</span>        <span class="n">another</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Generate another? (y/n) [y]: "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">'n'</span>
        <span class="k">if</span> <span class="n">another</span><span class="p">:</span>
            <span class="c1"># Clean up to free memory
</span>            <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Thank you for using AudioCraft Interactive Generator!"</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
        
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">Error generating audio: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
        <span class="c1"># Ask about trying again
</span>        <span class="n">try_again</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Would you like to try again? (y/n) [y]: "</span><span class="p">).</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">'n'</span>
        <span class="k">if</span> <span class="n">try_again</span><span class="p">:</span>
            <span class="c1"># Clean up to free memory
</span>            <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Exiting AudioCraft Interactive Generator."</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">False</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up to free memory
</span>        <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">():</span>
            <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="c1"># Run interactive session in a loop
</span>    <span class="n">continue_session</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">while</span> <span class="n">continue_session</span><span class="p">:</span>
        <span class="n">continue_session</span> <span class="o">=</span> <span class="n">generate_audio_interactive</span><span class="p">()</span>
</code></pre></div></div>

<p>This interactive script gives you a user-friendly way to experiment with different settings and quickly iterate on your audio generation.</p>

<h2 id="hands-on-challenge">Hands-on Challenge</h2>

<p>Now it’s your turn to experiment with what you’ve learned. Try the following challenge:</p>

<h3 id="challenge-theme-based-audio-generator">Challenge: Theme-Based Audio Generator</h3>

<p>Create a script that:</p>
<ol>
  <li>Takes a theme (e.g., “nature”, “urban”, “space”) as input</li>
  <li>Generates multiple audio files (both music and sound effects) related to that theme</li>
  <li>Creates a simple HTML page that displays all the generated audio with playback controls</li>
  <li>Uses different generation parameters for each audio piece to create variety</li>
</ol>

<p>This challenge will reinforce your understanding of audio generation while creating a useful tool for theme-based projects.</p>

<h2 id="key-takeaways">Key Takeaways</h2>

<ul>
  <li>AudioCraft provides two main models: MusicGen for music and AudioGen for sound effects</li>
  <li>The basic workflow is similar for both: load model, set parameters, generate, save</li>
  <li>Generation parameters like temperature and top-k significantly affect the output</li>
  <li>Hardware acceleration (GPU) makes generation much faster</li>
  <li>Detailed, specific prompts produce better results than vague ones</li>
  <li>Error handling and memory management are important for robust generation</li>
</ul>

<h2 id="next-steps">Next Steps</h2>

<p>Now that you’ve successfully generated your first audio with AudioCraft, you’re ready to explore more specialized topics:</p>

<ul>
  <li><a href="/chapters/part2/basic-music/">Basic Music Generation</a>: Dive deeper into music generation with MusicGen</li>
  <li><a href="/chapters/part3/basic-sound-effects/">Basic Sound Effect Generation</a>: Create sound effects and environments with AudioGen</li>
  <li><a href="/chapters/part2/prompt-engineering/">Prompt Engineering for Music</a>: Learn techniques for crafting effective music prompts</li>
</ul>

<h2 id="further-reading">Further Reading</h2>

<ul>
  <li><a href="https://github.com/facebookresearch/audiocraft/tree/main/examples">AudioCraft GitHub Examples</a></li>
  <li><a href="https://pytorch.org/audio/stable/index.html">PyTorch Audio Documentation</a></li>
  <li><a href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html#IPython.display.Audio">IPython Audio Playback</a></li>
</ul>

  
  
  
  
  
  
  <div class="next-steps">
    <h2>Next Steps</h2>
    <p>Now that you've mastered 4 your first audio generation, you're ready to explore:</p>
    <ul>
      
      <li>
        <a href="/chapters/part2/basic-music/">Basic Music Generation</a>: Dive deeper into music generation with MusicGen
      </li>
      
      <li>
        <a href="/chapters/part3/basic-sound-effects/">Basic Sound Effect Generation</a>: Create sound effects and environments with AudioGen
      </li>
      
      <li>
        <a href="/chapters/part2/prompt-engineering/">Prompt Engineering for Music</a>: Learn techniques for crafting effective music prompts
      </li>
      
    </ul>
  </div>
  
  
  
  <div class="further-reading">
    <h2>Further Reading</h2>
    <ul>
      
      <li>
        
        <a href="https://github.com/facebookresearch/audiocraft/tree/main/examples" target="_blank">AudioCraft GitHub Examples</a>
        
        
      </li>
      
      <li>
        
        <a href="https://pytorch.org/audio/stable/index.html" target="_blank">PyTorch Audio Documentation</a>
        
        
      </li>
      
      <li>
        
        <a href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html#IPython.display.Audio" target="_blank">IPython Audio Playback</a>
        
        
      </li>
      
    </ul>
  </div>
  
</div>

<div class="chapter-navigation">
  
  <a href="/chapters/part1/architecture/" class="prev-chapter">
    <span class="nav-label">Previous</span>
    <span class="nav-title">Chapter 3: Understanding AudioCraft Architecture</span>
  </a>
  
  
  
  <a href="/chapters/part1/introduction/" class="next-chapter">
    <span class="nav-label">Next</span>
    <span class="nav-title">Chapter 1: Introduction to AI Audio Generation</span>
  </a>
  
</div>

<!-- Copyright footer for all chapter pages -->
<div class="copyright-footer">
  <hr>
  <p>
    Copyright © 2025 Scott Friedman.
    <br>
    This work is licensed under the <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.
  </p>
</div>


        </div>
      </main>

      <footer class="site-footer">
        <div class="container">
          <div class="footer-col-wrapper">
            <div class="footer-col">
              <p>A hands-on guide to creating music, sound effects, and audio experiences with AI</p>
              <p>
                <a href="https://github.com/facebookresearch/audiocraft">AudioCraft GitHub Repository</a>
              </p>
            </div>
            <div class="footer-col">
              <p class="copyright">
                Copyright © 2025 Scott Friedman.<br>
                Licensed under <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a>.
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </body>
</html>