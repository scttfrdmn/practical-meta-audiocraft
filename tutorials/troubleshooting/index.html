<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AudioCraft Troubleshooting &amp;amp; FAQs</title>
  <meta name="description" content="A hands-on guide to creating music, sound effects, and audio experiences with AI">
  <link rel="canonical" href="https://scttfrdmn.github.io/practical-meta-audiocraft/tutorials/troubleshooting/">
  
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      margin: 0;
      padding: 0;
    }
    .wrapper {
      max-width: 100%;
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 0 20px;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    h1 { color: #1a73e8; }
    h2 { color: #34a853; }
    a {
      color: #1a73e8;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .site-header {
      border-bottom: 1px solid #eee;
      padding: 15px 0;
      margin-bottom: 30px;
    }
    .site-title {
      margin: 0;
      font-size: 1.8rem;
    }
    .site-title a {
      color: #1a73e8;
      text-decoration: none;
    }
    .site-nav {
      float: right;
      margin-top: 10px;
    }
    .site-nav .page-link {
      margin-left: 20px;
    }
    .nav-trigger {
      display: none;
    }
    .menu-icon {
      display: none;
    }
    .page-content {
      padding: 20px 0;
    }
    .site-footer {
      border-top: 1px solid #eee;
      padding: 30px 0;
      margin-top: 60px;
    }
    .footer-col-wrapper {
      display: flex;
      flex-wrap: wrap;
    }
    .footer-col {
      flex: 1;
      min-width: 200px;
      padding-right: 20px;
    }
    code {
      background-color: #f5f5f5;
      padding: 2px 5px;
      border-radius: 3px;
    }
    pre {
      background-color: #f5f5f5;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
    }
    .highlight {
      background-color: #f5f5f5;
      border-radius: 5px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
    }
    th {
      background-color: #f5f5f5;
      text-align: left;
    }
    button, .button {
      display: inline-block;
      background-color: #1a73e8;
      color: white !important;
      padding: 10px 20px;
      border-radius: 4px;
      font-weight: bold;
      margin-top: 20px;
      border: none;
      cursor: pointer;
      text-decoration: none !important;
    }
    button:hover, .button:hover {
      background-color: #0d65d9;
    }
    .feature {
      background-color: #f5f5f5;
      border-radius: 8px;
      padding: 20px;
      border-left: 4px solid #1a73e8;
      margin-bottom: 20px;
    }
    
    @media screen and (max-width: 600px) {
      .site-nav {
        position: absolute;
        top: 70px;
        right: 20px;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 5px;
        text-align: right;
        padding: 0;
        z-index: 1;
      }
      .site-nav .page-link {
        display: block;
        padding: 10px;
        margin: 0;
      }
      .site-nav .menu-icon {
        display: block;
        float: right;
        width: 36px;
        height: 26px;
        line-height: 0;
        padding-top: 10px;
        text-align: center;
      }
      .site-nav .trigger {
        clear: both;
        display: none;
      }
      .site-nav input:checked ~ .trigger {
        display: block;
        padding-bottom: 5px;
      }
      .footer-col-wrapper {
        flex-direction: column;
      }
      .footer-col {
        margin-bottom: 20px;
      }
    }
  </style>
</head><body>
    <div class="wrapper">
      <header class="site-header">
        <div class="container">
          <h1 class="site-title"><a href="/practical-meta-audiocraft/">Practical Meta AudioCraft</a></h1>
          <nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
              <span class="menu-icon">
                <svg viewBox="0 0 18 15" width="18px" height="15px">
                  <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484c0-0.82,0.665-1.485,1.484-1.485 h15.032C17.335,0,18,0.665,18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516 c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,6.031,18,6.696,18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516c0-0.82,0.665-1.483,1.484-1.483h15.032 C17.335,12.031,18,12.696,18,13.516z"/>
                </svg>
              </span>
            </label>

            <div class="trigger">
              <a class="page-link" href="/practical-meta-audiocraft/">Home</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part1/introduction/">Getting Started</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part2/basic-music/">MusicGen</a>
              <a class="page-link" href="/practical-meta-audiocraft/chapters/part3/introduction-to-audiogen/">AudioGen</a>
              <a class="page-link" href="/practical-meta-audiocraft/tutorials/getting-started/">Tutorials</a>
            </div>
          </nav>
        </div>
      </header>

      <main class="page-content" aria-label="Content">
        <div class="container">
          <article class="post">

  <header class="post-header">
    <h1 class="post-title">AudioCraft Troubleshooting &amp;amp; FAQs</h1>
  </header>

  <div class="post-content">
    <h1 id="audiocraft-troubleshooting--faqs">AudioCraft Troubleshooting &amp; FAQs</h1>

<p>This guide addresses common issues, questions, and solutions when working with Meta’s AudioCraft framework. Whether you’re encountering installation problems, generation errors, or looking for ways to optimize performance, you’ll find helpful information here.</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#installation-issues">Installation Issues</a></li>
  <li><a href="#audiocraft-model-loading-issues">AudioCraft Model Loading Issues</a></li>
  <li><a href="#generation-problems">Generation Problems</a></li>
  <li><a href="#memory-and-performance">Memory and Performance</a></li>
  <li><a href="#platform-specific-issues">Platform-Specific Issues</a></li>
  <li><a href="#audio-quality-issues">Audio Quality Issues</a></li>
  <li><a href="#integration-challenges">Integration Challenges</a></li>
  <li><a href="#common-error-messages">Common Error Messages</a></li>
</ul>

<h2 id="installation-issues">Installation Issues</h2>

<h3 id="pytorch-installation-errors">PyTorch Installation Errors</h3>

<p><strong>Problem</strong>: Errors when installing PyTorch with CUDA support.</p>

<p><strong>Solution</strong>:</p>
<ol>
  <li>Visit <a href="https://pytorch.org/get-started/locally/">PyTorch’s official installation page</a> for the correct command for your system.</li>
  <li>For Mac users with Apple Silicon, use:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span><span class="nv">torch</span><span class="o">==</span>2.1.0 <span class="nv">torchaudio</span><span class="o">==</span>2.1.0
</code></pre></div>    </div>
  </li>
  <li>For CUDA users, specify the CUDA version that matches your drivers:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example for CUDA 11.8</span>
pip <span class="nb">install </span><span class="nv">torch</span><span class="o">==</span>2.1.0 <span class="nv">torchaudio</span><span class="o">==</span>2.1.0 <span class="nt">--index-url</span> https://download.pytorch.org/whl/cu118
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="audiocraft-installation-failures">AudioCraft Installation Failures</h3>

<p><strong>Problem</strong>: <code class="language-plaintext highlighter-rouge">pip install audiocraft</code> fails with dependency errors.</p>

<p><strong>Solution</strong>:</p>
<ol>
  <li>Ensure you have the latest pip: <code class="language-plaintext highlighter-rouge">pip install --upgrade pip</code></li>
  <li>Install in a clean virtual environment:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-m</span> venv audiocraft_env
<span class="nb">source </span>audiocraft_env/bin/activate  <span class="c"># On Windows: audiocraft_env\Scripts\activate</span>
pip <span class="nb">install </span>audiocraft
</code></pre></div>    </div>
  </li>
  <li>If still failing, install from source:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/facebookresearch/audiocraft.git
<span class="nb">cd </span>audiocraft
pip <span class="nb">install</span> <span class="nt">-e</span> <span class="nb">.</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="ffmpeg-missing">FFmpeg Missing</h3>

<p><strong>Problem</strong>: Errors about missing FFmpeg during audio processing.</p>

<p><strong>Solution</strong>:</p>
<ul>
  <li><strong>On macOS</strong>: <code class="language-plaintext highlighter-rouge">brew install ffmpeg</code></li>
  <li><strong>On Ubuntu/Debian</strong>: <code class="language-plaintext highlighter-rouge">sudo apt-get install ffmpeg</code></li>
  <li><strong>On Windows</strong>: Download from <a href="https://ffmpeg.org/download.html">FFmpeg website</a> or use <code class="language-plaintext highlighter-rouge">conda install -c conda-forge ffmpeg</code></li>
</ul>

<h2 id="audiocraft-model-loading-issues">AudioCraft Model Loading Issues</h2>

<h3 id="models-fail-to-download">Models Fail to Download</h3>

<p><strong>Problem</strong>: Error when trying to load pretrained models.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Check internet connection</strong> and firewall settings.</li>
  <li><strong>Manually download models</strong> from Hugging Face:
    <ul>
      <li>Visit <a href="https://huggingface.co/facebook/MusicGen">facebook/MusicGen</a> or <a href="https://huggingface.co/facebook/AudioGen">facebook/AudioGen</a></li>
      <li>Download the model files to the default cache location:
        <ul>
          <li>Linux/Mac: <code class="language-plaintext highlighter-rouge">~/.cache/huggingface/hub</code></li>
          <li>Windows: <code class="language-plaintext highlighter-rouge">C:\Users\&lt;username&gt;\.cache\huggingface\hub</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Set custom cache directory</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="s">"HF_HOME"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"/path/to/custom/directory"</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="out-of-memory-when-loading-models">Out of Memory When Loading Models</h3>

<p><strong>Problem</strong>: OOM errors when loading larger models.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Use a smaller model size (<code class="language-plaintext highlighter-rouge">small</code> instead of <code class="language-plaintext highlighter-rouge">medium</code> or <code class="language-plaintext highlighter-rouge">large</code>).</li>
  <li>Load the model in CPU mode first, then move specific components to GPU:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">audiocraft.models</span> <span class="kn">import</span> <span class="n">MusicGen</span>
   
<span class="c1"># Load on CPU first
</span><span class="n">model</span> <span class="o">=</span> <span class="n">MusicGen</span><span class="p">.</span><span class="n">get_pretrained</span><span class="p">(</span><span class="s">'medium'</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s">"cpu"</span><span class="p">)</span>
   
<span class="c1"># Move only necessary components to GPU
</span><span class="n">model</span><span class="p">.</span><span class="n">lm</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">lm</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="s">"cuda"</span><span class="p">)</span>  <span class="c1"># Move only the language model to GPU
</span></code></pre></div>    </div>
  </li>
  <li>Reduce batch size and ensure no other large models are loaded.</li>
</ol>

<h2 id="generation-problems">Generation Problems</h2>

<h3 id="generation-hangs-or-is-very-slow">Generation Hangs or is Very Slow</h3>

<p><strong>Problem</strong>: Audio generation takes extremely long or seems to hang.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>The <strong>first generation is always slowest</strong> due to model loading and compilation.</li>
  <li><strong>Reduce duration</strong> parameter for faster generation.</li>
  <li><strong>Use a smaller model size</strong> (e.g., <code class="language-plaintext highlighter-rouge">small</code> instead of <code class="language-plaintext highlighter-rouge">medium</code> or <code class="language-plaintext highlighter-rouge">large</code>).</li>
  <li><strong>Check your hardware</strong>: CPU generation can be 10-20x slower than GPU.</li>
  <li>If using Apple Silicon, <strong>ensure MPS is being used</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"MPS available: </span><span class="si">{</span><span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="unexpected-generation-results">Unexpected Generation Results</h3>

<p><strong>Problem</strong>: Audio output doesn’t match the prompt or sounds wrong.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Improve your prompt</strong>: Be more specific about instruments, style, tempo, mood.</li>
  <li><strong>Adjust temperature</strong>: Lower (0.3-0.7) for more predictable results, higher for more creativity.</li>
  <li><strong>Try different model sizes</strong>: Larger models generally produce better quality results.</li>
  <li><strong>Check your audio output settings</strong>: Sample rate mismatches can cause distortion.</li>
</ol>

<h2 id="memory-and-performance">Memory and Performance</h2>

<h3 id="out-of-memory-during-generation">Out of Memory During Generation</h3>

<p><strong>Problem</strong>: CUDA out of memory or similar errors during generation.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Reduce batch size</strong> (generate one at a time).</li>
  <li><strong>Use a smaller model size</strong> (switch from <code class="language-plaintext highlighter-rouge">large</code> to <code class="language-plaintext highlighter-rouge">medium</code> or <code class="language-plaintext highlighter-rouge">small</code>).</li>
  <li><strong>Decrease the generation duration</strong>.</li>
  <li><strong>Free unused memory</strong> before generation:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">empty_cache</span><span class="p">()</span>  <span class="c1"># For CUDA
</span></code></pre></div>    </div>
  </li>
  <li><strong>Monitor GPU memory</strong> with <code class="language-plaintext highlighter-rouge">nvidia-smi</code> (CUDA) or Activity Monitor (Mac).</li>
</ol>

<h3 id="slow-generation-on-good-hardware">Slow Generation on Good Hardware</h3>

<p><strong>Problem</strong>: Generation is slower than expected despite good GPU.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Check if GPU is actually being used</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Device being used: </span><span class="si">{</span><span class="nb">next</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">parameters</span><span class="p">()).</span><span class="n">device</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Ensure PyTorch was installed with GPU support</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"CUDA available: </span><span class="si">{</span><span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"MPS available: </span><span class="si">{</span><span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Update GPU drivers</strong> to the latest version.</li>
  <li><strong>Optimize batch processing</strong>: Generate multiple outputs in one batch rather than one at a time.</li>
</ol>

<h2 id="platform-specific-issues">Platform-Specific Issues</h2>

<h3 id="mac-apple-silicon-issues">Mac (Apple Silicon) Issues</h3>

<p><strong>Problem</strong>: Not utilizing GPU acceleration on M1/M2/M3/M4 Mac.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Install PyTorch with MPS support</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span><span class="nv">torch</span><span class="o">==</span>2.1.0 <span class="nv">torchaudio</span><span class="o">==</span>2.1.0
</code></pre></div>    </div>
  </li>
  <li><strong>Explicitly use MPS device</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">device</span><span class="p">(</span><span class="s">"mps"</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">backends</span><span class="p">.</span><span class="n">mps</span><span class="p">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s">"cpu"</span><span class="p">)</span>
<span class="n">model</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Ensure macOS version is 12.3+</strong> (required for MPS support).</li>
  <li><strong>Be aware of MPS limitations</strong>: Some operations might fall back to CPU.</li>
</ol>

<h3 id="windows-specific-issues">Windows-Specific Issues</h3>

<p><strong>Problem</strong>: Various installation or runtime errors on Windows.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Use Anaconda/Miniconda environment</strong> instead of plain pip.</li>
  <li><strong>Install Visual C++ Redistributable</strong> if getting DLL errors.</li>
  <li><strong>Use Python 3.9 or 3.10</strong> for best compatibility.</li>
  <li><strong>Path length issues</strong>: Install in a directory with a shorter path.</li>
</ol>

<h3 id="linux-gpu-acceleration-problems">Linux GPU Acceleration Problems</h3>

<p><strong>Problem</strong>: CUDA not working properly on Linux.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Verify CUDA installation</strong>: <code class="language-plaintext highlighter-rouge">nvcc --version</code></li>
  <li><strong>Ensure PyTorch CUDA version matches system CUDA</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">version</span><span class="p">.</span><span class="n">cuda</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Check NVIDIA drivers</strong>: <code class="language-plaintext highlighter-rouge">nvidia-smi</code></li>
  <li><strong>Set environment variables</strong> if needed:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:/usr/local/cuda/lib64
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="audio-quality-issues">Audio Quality Issues</h2>

<h3 id="poor-audio-quality">Poor Audio Quality</h3>

<p><strong>Problem</strong>: Generated audio has low quality, artifacts, or distortion.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Use a larger model size</strong> (<code class="language-plaintext highlighter-rouge">medium</code> or <code class="language-plaintext highlighter-rouge">large</code>).</li>
  <li><strong>Adjust generation parameters</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="p">.</span><span class="n">set_generation_params</span><span class="p">(</span>
    <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>  <span class="c1"># Try between 0.5-1.0
</span>    <span class="n">top_k</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">top_p</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Use specific audio formats</strong> in prompts (e.g., “high-quality stereo recording”).</li>
  <li><strong>Apply post-processing</strong>: Consider using audio enhancement tools or filters.</li>
</ol>

<h3 id="abrupt-audio-endings">Abrupt Audio Endings</h3>

<p><strong>Problem</strong>: Generated audio cuts off abruptly.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Increase duration parameter</strong>.</li>
  <li><strong>Apply fadeout effect</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Apply a simple fadeout to the end of the audio
</span><span class="k">def</span> <span class="nf">apply_fadeout</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span> <span class="n">fade_samples</span><span class="o">=</span><span class="mi">3000</span><span class="p">):</span>
    <span class="n">fade</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fade_samples</span><span class="p">)</span>
    <span class="n">audio</span><span class="p">[</span><span class="o">-</span><span class="n">fade_samples</span><span class="p">:]</span> <span class="o">*=</span> <span class="n">fade</span>
    <span class="k">return</span> <span class="n">audio</span>
   
<span class="c1"># Apply fadeout before saving
</span><span class="n">generated_audio</span> <span class="o">=</span> <span class="n">apply_fadeout</span><span class="p">(</span><span class="n">generated_audio</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Try prompt engineering</strong>: Add terms like “with proper ending” or “with fade out ending”.</li>
</ol>

<h2 id="integration-challenges">Integration Challenges</h2>

<h3 id="combining-with-other-libraries">Combining with Other Libraries</h3>

<p><strong>Problem</strong>: Errors when integrating AudioCraft with other audio or ML libraries.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Check for device mismatches</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Ensure all tensors are on the same device
</span><span class="n">tensor1</span> <span class="o">=</span> <span class="n">tensor1</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">tensor2</span> <span class="o">=</span> <span class="n">tensor2</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Handle different audio formats</strong>: Convert sample rates and channels as needed:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torchaudio.functional</span> <span class="k">as</span> <span class="n">F</span>
   
<span class="c1"># Resample audio if necessary
</span><span class="k">if</span> <span class="n">source_sr</span> <span class="o">!=</span> <span class="n">target_sr</span><span class="p">:</span>
    <span class="n">audio</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">resample</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span> <span class="n">source_sr</span><span class="p">,</span> <span class="n">target_sr</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Convert between libraries</strong>: Use NumPy as an intermediate format:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Convert from AudioCraft output to librosa format
</span><span class="n">audio_np</span> <span class="o">=</span> <span class="n">audio_tensor</span><span class="p">.</span><span class="n">cpu</span><span class="p">().</span><span class="n">numpy</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="web-integration-issues">Web Integration Issues</h3>

<p><strong>Problem</strong>: Difficulties embedding AudioCraft in web applications.</p>

<p><strong>Solutions</strong>:</p>
<ol>
  <li><strong>Use Gradio for quick web interfaces</strong>:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">gradio</span> <span class="k">as</span> <span class="n">gr</span>
   
<span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
    <span class="c1"># AudioCraft generation code here
</span>    <span class="k">return</span> <span class="n">output_path</span>
   
<span class="n">interface</span> <span class="o">=</span> <span class="n">gr</span><span class="p">.</span><span class="n">Interface</span><span class="p">(</span>
    <span class="n">fn</span><span class="o">=</span><span class="n">generate</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="n">Textbox</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">"Prompt"</span><span class="p">),</span>
    <span class="n">outputs</span><span class="o">=</span><span class="n">gr</span><span class="p">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s">"Generated Audio"</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">interface</span><span class="p">.</span><span class="n">launch</span><span class="p">()</span>
</code></pre></div>    </div>
  </li>
  <li><strong>For production</strong>: Create a REST API with Flask or FastAPI.</li>
  <li><strong>Consider compute requirements</strong>: Web servers might need GPU access.</li>
</ol>

<h2 id="common-error-messages">Common Error Messages</h2>

<h3 id="runtimeerror-cuda-out-of-memory">“RuntimeError: CUDA out of memory”</h3>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Use a smaller model.</li>
  <li>Reduce the duration of generated audio.</li>
  <li>Generate one sample at a time instead of batches.</li>
  <li>Close other GPU-intensive applications.</li>
</ol>

<h3 id="runtimeerror-mps-backend-out-of-memory">“RuntimeError: MPS backend out of memory”</h3>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Same as CUDA out of memory, plus:</li>
  <li>Restart your Python session (MPS memory management is less robust).</li>
  <li>Consider using <code class="language-plaintext highlighter-rouge">device="cpu"</code> if the model is too large for your Mac’s memory.</li>
</ol>

<h3 id="modulenotfounderror-no-module-named-audiocraft">“ModuleNotFoundError: No module named ‘audiocraft’”</h3>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Check installation: <code class="language-plaintext highlighter-rouge">pip list | grep audiocraft</code></li>
  <li>Reinstall: <code class="language-plaintext highlighter-rouge">pip install -U audiocraft</code></li>
  <li>Make sure you’re in the correct virtual environment.</li>
</ol>

<h3 id="assertionerror-generation-with-duration--x-not-supported-by-model">“AssertionError: generation with duration &gt; X not supported by model”</h3>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Reduce the requested duration to be within model limits.</li>
  <li>For longer generations, look at the advanced tutorials on combining multiple generations.</li>
</ol>

<h3 id="runtimeerror-expected-all-tensors-to-be-on-the-same-device">“RuntimeError: Expected all tensors to be on the same device”</h3>

<p><strong>Solutions</strong>:</p>
<ol>
  <li>Explicitly move all tensors to the same device:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">device</span><span class="p">(</span><span class="s">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s">"cpu"</span><span class="p">)</span>
<span class="n">tensor1</span> <span class="o">=</span> <span class="n">tensor1</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">tensor2</span> <span class="o">=</span> <span class="n">tensor2</span><span class="p">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>Check your code for device inconsistencies.</li>
</ol>

<h2 id="additional-resources">Additional Resources</h2>

<ul>
  <li><a href="https://github.com/facebookresearch/audiocraft">AudioCraft GitHub Repository</a></li>
  <li><a href="https://pytorch.org/docs/stable/index.html">PyTorch Documentation</a></li>
  <li><a href="https://huggingface.co/models?pipeline_tag=audio">Hugging Face Audio Models</a></li>
  <li><a href="https://developer.apple.com/metal/pytorch/">Mac Metal Developer Guide</a></li>
</ul>

<h2 id="reporting-new-issues">Reporting New Issues</h2>

<p>If you encounter issues not covered in this guide, please:</p>

<ol>
  <li>Check the <a href="https://github.com/facebookresearch/audiocraft/issues">GitHub Issues</a> to see if it’s a known problem.</li>
  <li>Provide detailed information when reporting new issues:
    <ul>
      <li>OS and hardware details</li>
      <li>AudioCraft and PyTorch versions</li>
      <li>Complete error messages</li>
      <li>Minimal code example to reproduce the problem</li>
    </ul>
  </li>
</ol>

  </div>

</article>

        </div>
      </main>

      <footer class="site-footer">
        <div class="container">
          <div class="footer-col-wrapper">
            <div class="footer-col">
              <p>A hands-on guide to creating music, sound effects, and audio experiences with AI</p>
              <p>
                <a href="https://github.com/facebookresearch/audiocraft">AudioCraft GitHub Repository</a>
              </p>
            </div>
            <div class="footer-col">
              <p class="copyright">
                Copyright © 2025 Scott Friedman.<br>
                Licensed under <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a>.
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </body>
</html>